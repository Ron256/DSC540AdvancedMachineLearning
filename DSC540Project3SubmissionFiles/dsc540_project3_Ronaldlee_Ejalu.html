<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>















    




    
    
    
    


<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>DSC540 Project 3<a rel="noopener" class="anchor-link" href="#DSC540-Project-3">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>DePaul University<br/>
Ilyas Ustun, PhD<br/>
Chicago, IL</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Rules<a rel="noopener" class="anchor-link" href="#Rules">&#182;</a></h2><ul>
<li>Write your code under the corresponding questions. You are encouraged to use more than one cell.</li>
<li>Provide explanation in a separate Markdown formatted cell. </li>
<li>You can change the cell type by:<ul>
<li>Click on the outer area of the cell type you want to change,</li>
<li>Go to the top, and select either Code or Markdown from the dropdown menu.</li>
</ul>
</li>
<li>Be concise in your explanations and conclusions.</li>
<li>Write clear code and provide explanation to functions you create by using <code>#</code> comment sign.</li>
<li>Try to answer the questions by yourself. Use documentation from pandas, sklearn and similar libraries to solve the problem.</li>
<li>If you are stuck you can use different resources. Do not find an identical project and copy paste the solutions. </li>
<li>Write your name at the beginning of the jupyter notebook.</li>
</ul>
<p>Important:</p>
<ul>
<li><strong>Do NOT share the solutions with other people.</strong></li>
<li><strong>Do NOT share the solutions on the internet including but not limited to Github and other platforms.</strong></li>
<li>Sign the Honor Pledge below indicating that you have agreed to these rules listed here, and any other ethical and honor rules as required by the university.</li>
</ul>
<ul>
<li><strong>Deliverables:</strong><ol>
<li>The Python Jupyter notebook file named properly with your name. Example: dsc540_project1_john_doe.ipynb</li>
<li>The HTML output of this code notebook names the same way. Example: dsc540_project1_john_doe.html<ul>
<li>File -&gt; Download as -&gt; HTML  </li>
</ul>
</li>
</ol>
</li>
</ul>
<p><strong>DO NOT zip the files.</strong></p>
<p>Good Luck!</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Ronaldlee Ejalu<a rel="noopener" class="anchor-link" href="#Ronaldlee-Ejalu">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Honor Pledge:</strong><br/>
I pledge on my honor that I, <strong>Ronaldlee Ejalu</strong>, have followed the rules listed above, that I have not given or received any unauthorized assistance on this assignment.</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Project Description<a rel="noopener" class="anchor-link" href="#Project-Description">&#182;</a></h2><p>In this project we will be analyzing CO and NOX gas emissions from a power plant. The variables, their meanings and some statistics are given in the table below.</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><img src="PowerPlantEmissionsFeaturesTable.PNG" alt="PowerPlantEmissionsFeaturesTable"/></p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Import Libraries<a rel="noopener" class="anchor-link" href="#Import-Libraries">&#182;</a></h2><p><strong>Import the usual libraries for pandas and plotting, and sklearn.</strong></p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sklearn</span>
<span class="n">sklearn</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>&#39;1.0.2&#39;</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">RANDOM_STATE</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>These are the packages I used<a rel="noopener" class="anchor-link" href="#These-are-the-packages-I-used">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">RandomizedSearchCV</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span>  <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">VotingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">cross_val_predict</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>

<span class="c1"># initialize a list of regression models</span>
<span class="n">regressionModels</span><span class="o">=</span><span class="p">[]</span> 

<span class="c1"># initialize a list of classification models</span>
<span class="n">classificationModels</span><span class="o">=</span><span class="p">[]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<blockquote><p>NOTE: For the Kernel RBF SVM hyper parameter tuning use these parameters in the questions:</p>
</blockquote>

<pre><code>    &#39;C&#39;: [1, 10, 100, 1000]
    &#39;gamma&#39;: [0.001, 0.01, 0.1, 1]</code></pre>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Q1 [10]<a rel="noopener" class="anchor-link" href="#Q1-%5B10%5D">&#182;</a></h2><ul>
<li>Read in the dataset</li>
<li>How many rows and variables are there?</li>
</ul>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Get the Data<a rel="noopener" class="anchor-link" href="#Get-the-Data">&#182;</a></h4><p><strong>Use pandas to read in the datasets as a dataframe.</strong></p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;..\..\datasets\gas_emissions.csv&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Display the top 5 records</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[7]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AT</th>
      <th>AP</th>
      <th>AH</th>
      <th>AFDP</th>
      <th>GTEP</th>
      <th>TIT</th>
      <th>TAT</th>
      <th>TEY</th>
      <th>CDP</th>
      <th>CO</th>
      <th>NOX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.95320</td>
      <td>1020.1</td>
      <td>84.985</td>
      <td>2.5304</td>
      <td>20.116</td>
      <td>1048.7</td>
      <td>544.92</td>
      <td>116.27</td>
      <td>10.799</td>
      <td>7.4491</td>
      <td>113.250</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.21910</td>
      <td>1020.1</td>
      <td>87.523</td>
      <td>2.3937</td>
      <td>18.584</td>
      <td>1045.5</td>
      <td>548.50</td>
      <td>109.18</td>
      <td>10.347</td>
      <td>6.4684</td>
      <td>112.020</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.94915</td>
      <td>1022.2</td>
      <td>78.335</td>
      <td>2.7789</td>
      <td>22.264</td>
      <td>1068.8</td>
      <td>549.95</td>
      <td>125.88</td>
      <td>11.256</td>
      <td>3.6335</td>
      <td>88.147</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.00750</td>
      <td>1021.7</td>
      <td>76.942</td>
      <td>2.8170</td>
      <td>23.358</td>
      <td>1075.2</td>
      <td>549.63</td>
      <td>132.21</td>
      <td>11.702</td>
      <td>3.1972</td>
      <td>87.078</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.28580</td>
      <td>1021.6</td>
      <td>76.732</td>
      <td>2.8377</td>
      <td>23.483</td>
      <td>1076.2</td>
      <td>549.68</td>
      <td>133.58</td>
      <td>11.737</td>
      <td>2.3833</td>
      <td>82.515</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[8]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(7384, 11)</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>There are 7384 rows with 11 variables.</p>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7384 entries, 0 to 7383
Data columns (total 11 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   AT      7384 non-null   float64
 1   AP      7384 non-null   float64
 2   AH      7384 non-null   float64
 3   AFDP    7384 non-null   float64
 4   GTEP    7384 non-null   float64
 5   TIT     7384 non-null   float64
 6   TAT     7384 non-null   float64
 7   TEY     7384 non-null   float64
 8   CDP     7384 non-null   float64
 9   CO      7384 non-null   float64
 10  NOX     7384 non-null   float64
dtypes: float64(11)
memory usage: 634.7 KB
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Is there any missing data?<a rel="noopener" class="anchor-link" href="#Is-there-any-missing-data?">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># detect the number of missing values in the X dataframe of each variable and sum them up.</span>
<span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[10]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>AT      0
AP      0
AH      0
AFDP    0
GTEP    0
TIT     0
TAT     0
TEY     0
CDP     0
CO      0
NOX     0
dtype: int64</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>What is the average value of AP for those points who have CO levels above 3 $mg/m^3$?<a rel="noopener" class="anchor-link" href="#What-is-the-average-value-of-AP-for-those-points-who-have-CO-levels-above-3-$mg/m%5E3$?">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># lets create a mask for CO levels greater than 3 mg/m^3</span>
<span class="n">co_mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CO&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3</span>

<span class="c1"># we perform a subselection for all those points meeting the criteria specificied in the mask. </span>
<span class="n">df_co_greaterthan3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">co_mask</span><span class="p">]</span>

<span class="c1"># we find the average value of AP</span>
<span class="n">df_co_greaterthan3</span><span class="p">[</span><span class="s1">&#39;AP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[11]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>1015.6900173490633</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Create a correlation map between the variables. Which variables have high correlation (&gt; |0.9|)?<a rel="noopener" class="anchor-link" href="#Create-a-correlation-map-between-the-variables.-Which-variables-have-high-correlation-(%3E-%7C0.9%7C)?">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cormap</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cormap</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrBr&#39;</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>The variables with high correlation (&gt; |0.9|) are:
<li>AFDP and CDP.</li>
<li>AFDP and TEY.</li>
<li>GTEP and CDP.</li>
<li>GTEP and TEY.</li>
<li>TIT  and CDP.</li>
<li>TIT  and TEY.</li>
<li>TEY  and CDP.</li>
<li>AFDP and TIT.</li>
<li>GTEP and TIT.</li>
</ul>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Create a scatter plot of &#39;TEY&#39; vs &#39;CDP&#39;<a rel="noopener" class="anchor-link" href="#Create-a-scatter-plot-of-&#39;TEY&#39;-vs-&#39;CDP&#39;">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CDP&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TEY&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Create histograms for CO and NOX.<a rel="noopener" class="anchor-link" href="#Create-histograms-for-CO-and-NOX.">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">hplot</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># rename the y-axis to nothing</span>
<span class="n">hplot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">hplot</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NOX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># rename the y-axis to nothing</span>
<span class="n">hplot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Create a sctter plot of CO vs NOX.<a rel="noopener" class="anchor-link" href="#Create-a-sctter-plot-of-CO-vs-NOX.">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NOX&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CO&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Prepare data for machine learning<a rel="noopener" class="anchor-link" href="#Prepare-data-for-machine-learning">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>We will predict CO using all the other variables.</li>
<li>NOX, which is another emission gas, will not be used as predictor.</li>
<li>CO is a continuous variable, thus we will be doing regression.</li>
<li>Many of algorithms that do classification also have regression counterparts.</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">CO</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">X_train_orig</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Standardization of the data</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">ss</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_val</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[20]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(5316, 9)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[21]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(1329, 9)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[22]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(739, 9)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[23]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(5316,)</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Utility Functions<a rel="noopener" class="anchor-link" href="#Utility-Functions">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>You can create helper functions.
For example, create functions that take the score and store it in a dataframe for a specific model.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BEST PARAMS: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>

    <span class="c1">#means = results.cv_results_[&#39;mean_test_score&#39;]</span>
    <span class="c1">#stds = results.cv_results_[&#39;std_test_score&#39;]</span>
    <span class="c1">#for mean, std, params in zip(means, stds, results.cv_results_[&#39;params&#39;]):</span>
    <span class="c1">#    print(&#39;{:.3f} (+/-{:.2f}) for {}&#39;.format(round(mean, 3), round(std * 2, 3), params))</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">deriveRSquared</span><span class="p">(</span><span class="n">var_y_true</span><span class="p">,</span> <span class="n">var_y_pred</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function that returns the model&#39;s R^2 &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">var_y_true</span><span class="p">,</span> <span class="n">var_y_pred</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">deriveRMSE</span><span class="p">(</span><span class="n">var_y_true</span><span class="p">,</span> <span class="n">var_y_pred</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function that returns the model&#39;s RMSE(Root Mean Squared Error)&quot;&quot;&quot;</span>
    <span class="c1"># Using the mean_squared_error in sklearn.metrics with an extra parameter, squared, set to False.</span>
    <span class="k">return</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">var_y_true</span><span class="p">,</span> <span class="n">var_y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[27]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">deriveGridSearchCV</span><span class="p">(</span><span class="n">modelName</span><span class="p">,</span><span class="n">estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">score_v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that takes the base_estimator, parameters, training and validation sets as parameters&#39; </span>
<span class="sd">    values to perform a GridSearchCV with a goal of finding the best hyper parameters.</span>
<span class="sd">    This function prints the R^2, and RMSE scores on both training and validation.</span>
<span class="sd">    It also returns the model&#39;s prediction on the training and validation data. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">score_v</span> <span class="o">==</span> <span class="s1">&#39;f1&#39;</span><span class="p">:</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">score_v</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># derive a GridSearchCV object</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">score_v</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># you can decrease the number  cross validation so that it can faster</span>

    <span class="c1"># fit the object with the training data.</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">print_results</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># output the model&#39;s prediction on the training set</span>
    <span class="n">y_train_pred_gs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

    <span class="c1"># output the model&#39;s prediction on the validation data</span>
    <span class="n">y_val_pred_gs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>

    <span class="c1"># R^2 on the training data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s R^2 on the training data set is </span><span class="si">%.3f</span><span class="s2">.&quot;</span><span class="o">%</span><span class="k">deriveRSquared</span>(y_train, y_train_pred_gs))

    <span class="c1"># R^2 on the validation data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s R^2 on the validation data set is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRSquared</span>(y_val, y_val_pred_gs))

    <span class="c1"># RMSE on the training data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The model&#39;s RMSE on the training data  is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRMSE</span>(y_train, y_train_pred_gs))

    <span class="c1"># RMSE on the validation data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s RMSE on the training data  is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRMSE</span>(y_val, y_val_pred_gs))
    
    <span class="c1"># return the model&#39;s prediction on training and validation data</span>
    <span class="k">return</span> <span class="n">modelName</span><span class="p">,</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRSquared</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred_gs</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRSquared</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_gs</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRMSE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred_gs</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRMSE</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_gs</span><span class="p">)),</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[28]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">deriveConfusionMatrix</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">val_pred</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that the utiliizes the confusion matrix to calculate and print </span>
<span class="sd">    the following metrics: Recall(Sensitivity), Specificity, Precision, Balanced Accuracy, and F1-Score </span>
<span class="sd">    and also displays the confusion matrix &quot;&quot;&quot;</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The Confusion Matrix is given below:&#39;</span><span class="p">)</span>
    <span class="c1"># create a confusion matrix</span>
    <span class="n">metrics</span><span class="o">.</span><span class="n">ConfusionMatrixDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">val_pred</span><span class="p">)</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Using the classification report from the metrics package to calculate Recall(Sensitivity)</span>
    <span class="c1">#, Specificity, Precision and F1-Score.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The classification report is given below:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">val_pred</span><span class="p">))</span>

    <span class="c1"># Dynamically calculating Recall(Sensitivity), Specificity, Precision, Balanced Accuracy and F1-Score</span>
    <span class="n">TN</span><span class="p">,</span> <span class="n">FP</span><span class="p">,</span> <span class="n">FN</span><span class="p">,</span> <span class="n">TP</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">val_pred</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="c1"># return the elements of the matrix as array</span>

    <span class="n">Specificity</span> <span class="o">=</span> <span class="n">TN</span><span class="o">/</span><span class="p">(</span><span class="n">TN</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span>

    <span class="n">Precision</span> <span class="o">=</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span>

    <span class="n">Recall</span> <span class="o">=</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span>

    <span class="n">F1Score</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Precision</span> <span class="o">*</span> <span class="n">Recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Precision</span> <span class="o">+</span> <span class="n">Recall</span><span class="p">))</span>

    <span class="n">BalancedAccuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">Recall</span>  <span class="o">+</span> <span class="n">Specificity</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall (Sensivity): </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Recall</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Specificity: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Specificity</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Precision: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Precision</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Balanced Accuracy: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">BalancedAccuracy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;F1 Score: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">F1Score</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
    
    <span class="k">return</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">Recall</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">Specificity</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">Precision</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">BalancedAccuracy</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">F1Score</span><span class="p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[29]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">deriveVIF</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function that returns the VIF values of the different features&quot;&quot;&quot;</span>
    <span class="c1"># create a data frame</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="c1"># assign the different features are values to the features column of the data frame</span>
    <span class="n">vif</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">columns</span>
    
    <span class="c1"># loop through each feature indice and calculate its VIF value</span>
    <span class="n">vif</span><span class="p">[</span><span class="s1">&#39;VIF_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    
    <span class="k">return</span> <span class="n">vif</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[30]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">buildTheModel</span><span class="p">(</span><span class="n">modelName</span><span class="p">,</span> <span class="n">baseEstimator</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that returns the prediction on the training and validation data sets </span>
<span class="sd">    and also prints R squared and RMSE on training and validation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># fit the model on the training set</span>
    <span class="c1"># baseEstimator.fit(X_train, y_train)</span>
    
    <span class="c1"># output the model&#39;s prediction on the training data</span>
    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">baseEstimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    
    <span class="c1"># output the model&#39;s prediction on the validation data</span>
    <span class="n">y_val_pred</span> <span class="o">=</span> <span class="n">baseEstimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    
    <span class="c1"># R^2 on the training data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s R^2 on the training data is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRSquared</span>(y_train, y_train_pred))
    
    <span class="c1"># R^2 on the validation data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s R^2 on the validation data is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRSquared</span>(y_val, y_val_pred))
    
    <span class="c1"># Root Mean Squared Error (RMSE) on training data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The model&#39;s Root Mean Squared Error (RMSE) on the training data is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRMSE</span>(y_train, y_train_pred))
    
    <span class="c1"># Root Mean Squared Error (RMSE) on validation data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s Root Mean Squared Error (RMSE) on the validation data is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRMSE</span>(y_val, y_val_pred))
    
    <span class="n">r2_training</span> <span class="o">=</span> <span class="n">deriveRSquared</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
    <span class="n">r2_validation</span> <span class="o">=</span> <span class="n">deriveRSquared</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)</span>
    <span class="n">rmse_training</span> <span class="o">=</span> <span class="n">deriveRMSE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
    <span class="n">rmse_validation</span> <span class="o">=</span> <span class="n">deriveRMSE</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)</span>
    
    
    <span class="c1"># regressionModels.append(modelName, r2_training, r2_validation, rmse_training, rmse_validation)</span>
    
    <span class="c1"># return the model&#39;s prediction on the training and validation data sets.</span>
    <span class="c1">#return y_train_pred, y_val_pred</span>
    <span class="k">return</span> <span class="n">modelName</span><span class="p">,</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRSquared</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRSquared</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRMSE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRMSE</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">))</span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[31]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">roundOffValue</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A function that returns a number rounded off two decimal places&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">num</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[32]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">deriveClassifierObject</span><span class="p">(</span><span class="n">modelName</span><span class="p">,</span> <span class="n">classifier</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;function that returns the classifier&#39;s metrics after fitting the model </span>
<span class="sd">    and printing the classifier&#39;s metrics, confusion matrics and classification report</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># fit the object with the training data.</span>
    <span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>

    <span class="c1"># output the model&#39;s prediction on the training set</span>
    <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

    
    <span class="c1"># output the model&#39;s prediction on the validation data</span>
    <span class="n">y_val_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s accuracy on training is : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">str</span>(roundOffValue(metrics.accuracy_score(y_true=y_train, y_pred=y_train_pred))))
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s accuracy on validation is : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">str</span>(roundOffValue(metrics.accuracy_score(y_true=y_val, y_pred=y_val_pred))))

    <span class="c1"># A helper function that prints Recall(Sensitivity), Specificity, Precision, Balanced Accuracy, and F1-Score</span>
    <span class="c1"># and also outputs the Confusion Matrix plus the  classification report. </span>
    <span class="n">class_Metrics</span><span class="o">=</span><span class="n">deriveConfusionMatrix</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)</span>
    
    <span class="c1"># print(&#39;type of class_Metrics is %s&#39; %type(class_Metrics))</span>
    <span class="n">listOfMetrics</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">class_Metrics</span><span class="p">)</span>
    <span class="n">all_metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">modelName</span><span class="p">,</span> 
                   <span class="n">roundOffValue</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">y_train_pred</span><span class="p">)),</span> 
                   <span class="n">roundOffValue</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">y_val_pred</span><span class="p">)),</span> 
                  <span class="p">]</span>
    
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">listOfMetrics</span><span class="p">:</span>
        <span class="n">all_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">all_metrics</span> <span class="c1"># return the classifier&#39;s metrics</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[33]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">classGridSearchCV</span><span class="p">(</span><span class="n">modelName</span><span class="p">,</span> <span class="n">estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">score_v</span><span class="p">):</span>

    <span class="c1"># perform a grid Search</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">score_v</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># fit the object with the training data.</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">)</span>

    <span class="n">print_results</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># output the model&#39;s prediction on the training set</span>
    <span class="n">y_train_pred_gs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

    
    <span class="c1"># output the model&#39;s prediction on the validation data</span>
    <span class="n">y_val_pred_gs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s accuracy on training is : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">str</span>(roundOffValue(metrics.accuracy_score(y_true=y_train_cat, y_pred=y_train_pred_gs))))
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s accuracy on validation is : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">str</span>(roundOffValue(metrics.accuracy_score(y_true=y_val_cat, y_pred=y_val_pred_gs))))

    <span class="c1"># A helper function that prints Recall(Sensitivity), Specificity, Precision, Balanced Accuracy, and F1-Score</span>
    <span class="c1"># and also outputs the Confusion Matrix plus the  classification report. </span>
    <span class="n">class_Metrics</span><span class="o">=</span><span class="n">deriveConfusionMatrix</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_val_pred_gs</span><span class="p">)</span>
    
    <span class="c1"># print(&#39;type of class_Metrics is %s&#39; %type(class_Metrics))</span>
    <span class="n">listOfMetrics</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">class_Metrics</span><span class="p">)</span>
    <span class="n">all_metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">modelName</span><span class="p">,</span> 
                   <span class="n">roundOffValue</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_train_cat</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">y_train_pred_gs</span><span class="p">)),</span> 
                   <span class="n">roundOffValue</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">y_val_pred_gs</span><span class="p">)),</span> 
                  <span class="p">]</span>
    
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">listOfMetrics</span><span class="p">:</span>
        <span class="n">all_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">all_metrics</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>Apply Linear Regression. Predict CO emission using other variables.<ul>
<li>What is the model $R^2$ on training data?</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the Root Mean Squared Error (RMSE) on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
</ul>
<blockquote><ul>
<li>$R^2$ higher is better. ($R^2$ is % variation in data being explained)  </li>
<li>RMSE lower is better. (RMSE (Root Mean Squared Error) is error, meaning the difference between predictions and actual data)  </li>
</ul>
</blockquote>
<p>Hint:</p>
<ul>
<li>You can use the <code>r2_score</code> and <code>mean_squared_error</code> methods in <code>sklearn.metrics</code>.   </li>
<li>You need to take the square root of Mean Squared Error to get to RMSE. (MSE $\rightarrow$ square root $\rightarrow$ RMSE)</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[34]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[35]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># initialize a LinearRegression object</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[36]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model on the training data</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[36]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>LinearRegression()</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[37]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initializes algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after fitting the model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Linear Regression&#39;</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.664.
The model&#39;s R^2 on the validation data is 0.646.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.272.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.388.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[38]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[39]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[39]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>We see that that RMSE on training and validation sets are 1.272 and 1.388 respectively. The RMSE of the validation set is much larger, which is an indicator that our model is overfitting the training data.</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Q3 [10]<a rel="noopener" class="anchor-link" href="#Q3-%5B10%5D">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li><p>Apply Random Forest Regression with 100 trees. Predict CO emission using other variables.</p>
<ul>
<li>What is the model $R^2$?</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the RMSE on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
<li><p>Is training and validation score close? If not what might be the problem?</p>
</li>
<li>If there is a large gap, try to decrease the gap by changing some hyperparameters of the Random Forest model. (In this analysis, any difference more than 0.10 $R^2$ difference can be assumed to be large.)<ul>
<li>Once you reach a difference of less than or close to 0.10 between training $R^2$ and validation $R^2$ you can stop. </li>
<li>During this process your training score will probably decrease, and that is OK. </li>
</ul>
</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[40]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[41]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># initialize a RandomForestRegressor object</span>
<span class="n">estimator_rfr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[42]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model on the training data</span>
<span class="n">estimator_rfr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[42]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>RandomForestRegressor(random_state=0)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[43]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initializes algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after fitting the model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Random Forest Regressor&#39;</span><span class="p">,</span><span class="n">estimator_rfr</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.964.
The model&#39;s R^2 on the validation data is 0.756.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 0.419.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.154.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[44]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[45]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[45]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>No, the training and validation scores are not close. The RMSE of 1.154 on the validation data is much larger, which is an indicator that the model is overfitting on the training data.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Using GridSearchCV to tune the different hyper-parameters<a rel="noopener" class="anchor-link" href="#Using-GridSearchCV-to-tune-the-different-hyper-parameters">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[46]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">900</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>  
<span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[46]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;min_samples_split&#39;: [2, 20, 40, 120],
 &#39;n_estimators&#39;: [100, 300, 600, 900],
 &#39;max_depth&#39;: [10, 20, 50, 500]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[47]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># initialize a RandomForestRegressor object</span>
<span class="n">rfr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[48]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># helper function that takes an initialized algorithm object, parameters, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after performing a GridSearchCV and fitting a model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">deriveGridSearchCV</span><span class="p">(</span><span class="s1">&#39;Random Forest Regressor with GridSearchCV&#39;</span><span class="p">,</span> <span class="n">rfr</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;max_depth&#39;: 50, &#39;min_samples_split&#39;: 120, &#39;n_estimators&#39;: 600}



The model&#39;s R^2 on the training data set is 0.792.
The model&#39;s R^2 on the validation data set is 0.745.

The model&#39;s RMSE on the training data  is 1.002.
The model&#39;s RMSE on the training data  is 1.179.
Wall time: 5min 6s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[49]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># retrieve the best model and assign to rfr</span>
<span class="n">rfr</span><span class="o">=</span><span class="n">modelMetrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[50]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">modelMetrics</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[50]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[51]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics without the best model to the list of tuples.</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[52]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># items of the regression models list </span>
<span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[52]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The model&#39;s R^2 on training is 0.792, which decreased from 0.964 and it&#39;s R^2 on the validation data is 0.745 implying that there is a difference of 0.047 which is equivalent to 0.1 so we shall stop here.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Q4 [10]<a rel="noopener" class="anchor-link" href="#Q4-%5B10%5D">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li><p>Apply Support Vector Regression. Predict CO emission using other variables.</p>
<ul>
<li>What is the model $R^2$?</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the RMSE on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
<li><p>Do this for each of the models listed below using the default parameters:</p>
<ol>
<li><strong>Linear kernel SVR</strong>  </li>
<li><strong>Polynomial kernel SVR</strong>  </li>
<li><strong>RBF kernel SVR</strong> </li>
</ol>
</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[53]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Linear SVM Regressor<a rel="noopener" class="anchor-link" href="#Linear-SVM-Regressor">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[54]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">estimator_l_SVM_R</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[55]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model on the training set</span>
<span class="n">estimator_l_SVM_R</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[55]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>SVR(kernel=&#39;linear&#39;)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[56]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Linear SVM Regressor&#39;</span><span class="p">,</span><span class="n">estimator_l_SVM_R</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.624.
The model&#39;s R^2 on the validation data is 0.602.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.345.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.473.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[57]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples.</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[58]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[58]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The model&#39;s R^2 on both training and validation data is 0.624 and 0.602 respectively. The model&#39;s RMSE on validation, which is 1.473, is much larger implying that the model is overfitting on the training data. But since the difference between the model&#39;s R^2 on training and validation data is less than 0.1, there is no need to fine tune the different hyper-parameters of Linear SVM Regressor. </p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Polynomial Kernel SVM Regressor<a rel="noopener" class="anchor-link" href="#Polynomial-Kernel-SVM-Regressor">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[59]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="n">estimator_Poly_K_SVM_R</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;poly&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[60]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model on the training data</span>
<span class="n">estimator_Poly_K_SVM_R</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[60]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>SVR(kernel=&#39;poly&#39;)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[61]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Polynomial Kernel SVM Regressor&#39;</span><span class="p">,</span> <span class="n">estimator_Poly_K_SVM_R</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.740.
The model&#39;s R^2 on the validation data is 0.731.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.118.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.211.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[62]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[63]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[63]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The <b>Polynomial Kernel SVM Regressor</b> model&#39;s R^2 on both training and validation data is 0.740 and 0.731 respectively. Also, there is a difference of 0.01 in the R^2 scores between training and validation data. The model&#39;s RMSE on validation, which is 1.211 is much larger than training implying that the model is overfitting on the training data.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>RBF Kernel SVM Regressor<a rel="noopener" class="anchor-link" href="#RBF-Kernel-SVM-Regressor">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[64]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="n">estimator_rbf_K_SVM_R</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[65]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model on training data</span>
<span class="n">estimator_rbf_K_SVM_R</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[65]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>SVR()</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[66]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;RBF Kernel SVM Regressor&#39;</span><span class="p">,</span> <span class="n">estimator_rbf_K_SVM_R</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.765.
The model&#39;s R^2 on the validation data is 0.748.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.063.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.173.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[67]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[68]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[68]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The <b>RBF Kernel SVM Regressor</b> model&#39;s R^2 on both training and validation data is 0.765 and 0.748 respectively with a difference of 0.02 between training and validation R^2 scores. The model&#39;s RMSE on validation, which is 1.173 is much larger than training implying that the model is overfitting on the training data.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Q5 [10]<a rel="noopener" class="anchor-link" href="#Q5-%5B10%5D">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li><p>Take RBF Kernel SVM and perform hyperparameter tuning. See if you can increase the $R^2$ score.</p>
<ul>
<li><p>Use:</p>

<pre><code>&#39;C&#39;: [1, 10, 100, 1000]
&#39;gamma&#39;: [0.001, 0.01, 0.1, 1]  </code></pre>
</li>
<li><p>What is the model $R^2$?</p>
</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the RMSE on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[69]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[70]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="n">gridSCV_rbf_K_SVR</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[71]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> 
<span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[71]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;C&#39;: [1, 10, 100, 1000], &#39;gamma&#39;: [0.001, 0.01, 0.1, 1]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[72]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># helper function that takes an initialized algorithm object, parameters, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after performing a GridSearchCV and fitting a model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">deriveGridSearchCV</span><span class="p">(</span><span class="s1">&#39;RBF Kernel SVR with GridSearch&#39;</span><span class="p">,</span> <span class="n">gridSCV_rbf_K_SVR</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;C&#39;: 1000, &#39;gamma&#39;: 0.01}



The model&#39;s R^2 on the training data set is 0.792.
The model&#39;s R^2 on the validation data set is 0.757.

The model&#39;s RMSE on the training data  is 1.000.
The model&#39;s RMSE on the training data  is 1.151.
Wall time: 2min 53s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[73]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s retrieve the best model and assign it to the avariable</span>
<span class="n">gridSCV_rbf_K_SVR</span> <span class="o">=</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[74]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">gridSCV_rbf_K_SVR</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[74]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>SVR(C=1000, gamma=0.01)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[75]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples without the best model</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[76]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[76]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>This increases $R^2$.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Q6 [10]<a rel="noopener" class="anchor-link" href="#Q6-%5B10%5D">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li><p>Apply PCA and transform the data.</p>
<ul>
<li>For PCA we need to decide on the number of  components. Take sufficient number of components based on variance explained <ul>
<li>generally it is chosen as the number of components that can explain 90% of the variance </li>
<li>or cross-validation accuracy using an ML model.</li>
</ul>
</li>
</ul>
</li>
<li><p>Use the PCA transformed data to perform regression with hyper parameter tuning using the models:</p>
<ul>
<li>Linear Regression</li>
<li>Random Forest Regression</li>
<li>RBF Kernel Support Vector Regression</li>
</ul>
</li>
<li><p>For each model:</p>
<ul>
<li>What is the model $R^2$?</li>
<li>What is the $R^2$ on validation data?</li>
<li>What is the RMSE on training data?</li>
<li>What is the RMSE on validation data?</li>
</ul>
</li>
<li><p>Compare these models with their counterparts obtained before. For example: Compare <code>PCA RBF SVR</code> with the <code>RBF SVR model</code> from before. Do you observe any change in performance? Please explain.</p>
</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[77]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[78]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># fit the model using the training data</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># transform training, validation, testing data sets using the same model parameters</span>
<span class="n">X_train_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_val_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
<span class="n">X_test_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[79]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(),</span> <span class="s1">&#39;-o&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_train_pca</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_train_pca</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Components&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Variance Explained&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[0.58158952 0.78924196 0.88751722 0.94337792 0.98704348 0.9959942
 0.99975821 0.99992456 1.        ]
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Choose the number of components.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[80]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_train_pca2</span> <span class="o">=</span> <span class="n">X_train_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">X_val_pca2</span> <span class="o">=</span> <span class="n">X_val_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">X_test_pca2</span> <span class="o">=</span> <span class="n">X_test_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Linear Regression with PCA transformed data</strong></p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[81]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">lr_with_PCA_transformed_data</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[82]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model with PCA transformed data</span>
<span class="n">lr_with_PCA_transformed_data</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[82]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>LinearRegression()</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[83]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Linear Regression with PCA transformed data&#39;</span><span class="p">,</span><span class="n">lr_with_PCA_transformed_data</span><span class="p">,</span> <span class="n">X_train_pca2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val_pca2</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.656.
The model&#39;s R^2 on the validation data is 0.633.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.287.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.414.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[84]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples.</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[85]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[85]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Comparing both the linear Regression without PCA transformed data and the one with PCA transformed data, $R^2$ on the validation data set decreased from 0.646 to 0.633 when we used Linear Regression with PCA transformed data.</p>
<p>Also, the Root Mean Squared Error increased on both the training and validation data by applying the linear regression with PCA tranformed data.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>RF Regression with PCA transformed data</strong></p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[86]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rfr_With_PCA_transformed_data</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[87]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model on the PCA transformed data</span>
<span class="n">rfr_With_PCA_transformed_data</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[87]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>RandomForestRegressor(random_state=0)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[88]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Random Forest Regressor with PCA transformed data&#39;</span><span class="p">,</span> <span class="n">rfr_With_PCA_transformed_data</span><span class="p">,</span> <span class="n">X_train_pca2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val_pca2</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.963.
The model&#39;s R^2 on the validation data is 0.737.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 0.422.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.197.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[89]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples.</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[90]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[90]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41),
 (&#39;Random Forest Regressor with PCA transformed data&#39;, 0.96, 0.74, 0.42, 1.2)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The RSME of 1.197 on the validation data is much larger than that on the training data, which is an indicator that the model is overfitting on the training data.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Applying GridSearchCV to tune the different hyper-parameters<a rel="noopener" class="anchor-link" href="#Applying-GridSearchCV-to-tune-the-different-hyper-parameters">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[91]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[91]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;min_samples_split&#39;: [2, 20, 40, 120],
 &#39;n_estimators&#39;: [100, 300, 600],
 &#39;max_depth&#39;: [10, 20, 100],
 &#39;min_samples_leaf&#39;: [10, 20, 1000]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[92]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># initialize a RandomForestRegressor object</span>
<span class="n">rfr_GS_With_PCA_transformed_data</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[93]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># helper function that takes an initialized algorithm object, parameters, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after performing a GridSearchCV and fitting a model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">deriveGridSearchCV</span><span class="p">(</span><span class="s1">&#39;GridSearchCV Random Forest Regressor with PCA transformed data&#39;</span><span class="p">,</span> <span class="n">rfr_GS_With_PCA_transformed_data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train_pca2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val_pca2</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;max_depth&#39;: 100, &#39;min_samples_leaf&#39;: 10, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 600}



The model&#39;s R^2 on the training data set is 0.800.
The model&#39;s R^2 on the validation data set is 0.750.

The model&#39;s RMSE on the training data  is 0.981.
The model&#39;s RMSE on the training data  is 1.168.
Wall time: 2min 18s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[94]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s retrieve the best model and assign it to the avariable</span>
<span class="n">rfr_GS_With_PCA_transformed_data</span> <span class="o">=</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[95]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples without the best model</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[96]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[96]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41),
 (&#39;Random Forest Regressor with PCA transformed data&#39;, 0.96, 0.74, 0.42, 1.2),
 (&#39;GridSearchCV Random Forest Regressor with PCA transformed data&#39;,
  0.8,
  0.75,
  0.98,
  1.17)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Comparing this model with its counterpart obtained before, $R^2$ is 0.8 on training and 0.75 on validation so there is change in the model&#39;s performance, however, the model&#39;s RMSE on both training and validation didn&#39;t change much.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>SVM Regression with PCA transformed data</strong></p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[97]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rbf_K_SVR_With_PCA_transformed_data</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[98]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model on the PCA transformed data</span>
<span class="n">rbf_K_SVR_With_PCA_transformed_data</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_pca2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[98]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>SVR()</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[99]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;RBF Kernel SVR with PCA transformed data&#39;</span><span class="p">,</span> <span class="n">rbf_K_SVR_With_PCA_transformed_data</span><span class="p">,</span> <span class="n">X_train_pca2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val_pca2</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.760.
The model&#39;s R^2 on the validation data is 0.747.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.075.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.175.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[100]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples without the best model</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[101]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[101]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41),
 (&#39;Random Forest Regressor with PCA transformed data&#39;, 0.96, 0.74, 0.42, 1.2),
 (&#39;GridSearchCV Random Forest Regressor with PCA transformed data&#39;,
  0.8,
  0.75,
  0.98,
  1.17),
 (&#39;RBF Kernel SVR with PCA transformed data&#39;, 0.76, 0.75, 1.07, 1.17)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Applying GridSearchCV to tune different hyper-parameters<a rel="noopener" class="anchor-link" href="#Applying-GridSearchCV-to-tune-different-hyper-parameters">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[102]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
<span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> 
<span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[102]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;C&#39;: [1, 10, 100, 1000], &#39;gamma&#39;: [0.001, 0.01, 0.1, 1]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[103]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">gridSearchCV_rbf_K_SVR_with_PCA_transformed_data</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[104]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># helper function that takes an initialized algorithm object, parameters, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after performing a GridSearchCV and fitting a model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">deriveGridSearchCV</span><span class="p">(</span><span class="s1">&#39;GridSearchCV RBF Kernel SVR with PCA transformed data&#39;</span><span class="p">,</span> <span class="n">gridSearchCV_rbf_K_SVR_with_PCA_transformed_data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train_pca2</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val_pca2</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;C&#39;: 1000, &#39;gamma&#39;: 0.01}



The model&#39;s R^2 on the training data set is 0.785.
The model&#39;s R^2 on the validation data set is 0.752.

The model&#39;s RMSE on the training data  is 1.017.
The model&#39;s RMSE on the training data  is 1.163.
Wall time: 4min 40s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[105]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s retrieve the best model and assign it to the variable</span>
<span class="n">gridSearchCV_rbf_K_SVR_with_PCA_transformed_data</span><span class="o">=</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[106]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples without the best model</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[107]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[107]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41),
 (&#39;Random Forest Regressor with PCA transformed data&#39;, 0.96, 0.74, 0.42, 1.2),
 (&#39;GridSearchCV Random Forest Regressor with PCA transformed data&#39;,
  0.8,
  0.75,
  0.98,
  1.17),
 (&#39;RBF Kernel SVR with PCA transformed data&#39;, 0.76, 0.75, 1.07, 1.17),
 (&#39;GridSearchCV RBF Kernel SVR with PCA transformed data&#39;,
  0.79,
  0.75,
  1.02,
  1.16)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Comparing PCA RBF SVR with RBF SVR model, $R^2$ on training data is the same and it decreased by 0.01 on validation when we use PCA RBF SVR. From my observation there is no change in performance since the difference between training and validation $R^2$ is the same in both models.</p>
<p>Also, the model RMSE on training on training is 1.017 when PCA RBF SVR is applied where as in RBF SVR model, it is 1.00 so there was increase in the RMSE, which is not good. The same applies to the RMSE on validation, there is an increase in the RMSE scores. I would prefer to use the RBF SVR model since using PCA RBF SVR doesn&#39;t make the model&#39;s performance any better. </p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Q7 [10]<a rel="noopener" class="anchor-link" href="#Q7-%5B10%5D">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Let&#39;s do  classification<a rel="noopener" class="anchor-link" href="#Let&#39;s-do--classification">&#182;</a></h4>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>We will convert CO target values into binary form by comparing them to a threshold. $ 0 - 3  mg/m^3$ is the range of max 8-hour avg. ambient CO in most US cities. So let&#39;s take that.<br/>
<a rel="noopener" href="https://www.carbonmonoxidekills.com/are-you-at-risk/carbon-monoxide-levels/">CO Levels of Concern in Government Recommendations and Regulations</a></p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[108]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">Binarizer</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[109]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">binarizer</span> <span class="o">=</span> <span class="n">Binarizer</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[110]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y_train_cat</span> <span class="o">=</span> <span class="n">binarizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">y_val_cat</span> <span class="o">=</span> <span class="n">binarizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_val</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">y_test_cat</span> <span class="o">=</span> <span class="n">binarizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[111]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y_train_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_train_cat</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[112]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y_train_cat</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[113]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># QA</span>
<span class="n">y_val_cat</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[113]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(1329,)</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Fit RBF Kernel SVM Classifier<a rel="noopener" class="anchor-link" href="#Fit-RBF-Kernel-SVM-Classifier">&#182;</a></h3><h4>1. Standardized training data<a rel="noopener" class="anchor-link" href="#1.-Standardized-training-data">&#182;</a></h4><ul>
<li>Using the standardized training data perform grid search:<ul>
<li>Find the best combination of the <code>C</code> and <code>gamma</code> hyper-parameters.  </li>
</ul>
</li>
<li>For the best model:<ul>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the validation set:<ul>
<li>Create confusion matrix</li>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4>2. PCA transformed training data<a rel="noopener" class="anchor-link" href="#2.-PCA-transformed-training-data">&#182;</a></h4><ul>
<li>Using the <strong>pca</strong> transformed training data <code>X_train_pca2</code> perform grid search:<ul>
<li>Find the best combination of the <code>C</code> and <code>gamma</code> hyper-parameters.  </li>
</ul>
</li>
<li>For the best model:<ul>
<li>Either using the confusion matrix or the methods in <code>sklearn.metrics</code> get the following metrics on the validation set <code>X_val_pca2</code>:<ul>
<li>Create confusion matrix</li>
<li>Recall (Sensitivity)</li>
<li>Specificity</li>
<li>Precision</li>
<li>Balanced Accuracy</li>
<li>F1 Score</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[114]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[115]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">gridSearchCV_rbf_K_SVC</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span> <span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>SVC Model 1<a rel="noopener" class="anchor-link" href="#SVC-Model-1">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[116]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
<span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> 
<span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[116]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;C&#39;: [1, 10, 100, 1000], &#39;gamma&#39;: [0.001, 0.01, 0.1, 1]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[117]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># A helper function that returns the model&#39;s prediction accuracy on training and validation data </span>
<span class="c1"># after performing GridSearchCv to tune the different hyperparameters which it uses to fit the model </span>
<span class="c1"># and also prints the different metrics</span>
<span class="n">classifierMetrics</span><span class="p">,</span> <span class="n">gridSearchCV_rbf_K_SVC</span> <span class="o">=</span> <span class="n">classGridSearchCV</span><span class="p">(</span><span class="s1">&#39;GridSearchCV RBF Kernel SVC&#39;</span><span class="p">,</span> <span class="n">gridSearchCV_rbf_K_SVC</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;C&#39;: 1, &#39;gamma&#39;: 1}



The model&#39;s accuracy on training is : 0.94
The model&#39;s accuracy on validation is : 0.91

The Confusion Matrix is given below:
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
The classification report is given below:
              precision    recall  f1-score   support

         0.0       0.92      0.94      0.93       812
         1.0       0.90      0.87      0.88       517

    accuracy                           0.91      1329
   macro avg       0.91      0.90      0.91      1329
weighted avg       0.91      0.91      0.91      1329

Recall (Sensivity): 0.87
Specificity: 0.94
Precision: 0.9
Balanced Accuracy: 0.9
F1 Score: 0.88
Wall time: 16.7 s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[118]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># this is the best model</span>
<span class="n">gridSearchCV_rbf_K_SVC</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[118]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>SVC(C=1, gamma=1)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[119]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the list of the classifier metrics to the list of classification models</span>
<span class="n">classificationModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classifierMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[120]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">classificationModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[120]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[[&#39;GridSearchCV RBF Kernel SVC&#39;, 0.94, 0.91, 0.87, 0.94, 0.9, 0.9, 0.88]]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>SVC Model 2<a rel="noopener" class="anchor-link" href="#SVC-Model-2">&#182;</a></h4>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>using the pca transformed data X_train_pca2 and X_val_pca2<a rel="noopener" class="anchor-link" href="#using-the-pca-transformed-data-X_train_pca2-and-X_val_pca2">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[121]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">gridSearchCV_rbf_K_SVC_With_PCA_transformed_data</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span> <span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[122]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
<span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> 
<span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[122]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;C&#39;: [1, 10, 100, 1000], &#39;gamma&#39;: [0.001, 0.01, 0.1, 1]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[123]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># A helper function that returns the model&#39;s prediction accuracy on training and validation data </span>
<span class="c1"># after performing GridSearchCv to tune the different hyperparameters which it uses to fit the model </span>
<span class="c1"># and also prints the different metrics</span>
<span class="n">classifierMetrics</span><span class="p">,</span> <span class="n">gridSearchCV_rbf_K_SVC_With_PCA_transformed_data</span> <span class="o">=</span> <span class="n">classGridSearchCV</span><span class="p">(</span><span class="s1">&#39;GridSearchCV RBF Kernel SVC With PCA transformed data&#39;</span><span class="p">,</span> <span class="n">gridSearchCV_rbf_K_SVC_With_PCA_transformed_data</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train_pca2</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">X_val_pca2</span><span class="p">,</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;C&#39;: 1, &#39;gamma&#39;: 1}



The model&#39;s accuracy on training is : 0.93
The model&#39;s accuracy on validation is : 0.91

The Confusion Matrix is given below:
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
The classification report is given below:
              precision    recall  f1-score   support

         0.0       0.92      0.94      0.93       812
         1.0       0.90      0.86      0.88       517

    accuracy                           0.91      1329
   macro avg       0.91      0.90      0.91      1329
weighted avg       0.91      0.91      0.91      1329

Recall (Sensivity): 0.86
Specificity: 0.94
Precision: 0.9
Balanced Accuracy: 0.9
F1 Score: 0.88
Wall time: 16.9 s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[124]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># this is our best model</span>
<span class="n">gridSearchCV_rbf_K_SVC_With_PCA_transformed_data</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[124]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>SVC(C=1, gamma=1)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[125]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the list of the classifier metrics to the list of classification models</span>
<span class="n">classificationModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classifierMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[126]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">classificationModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[126]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[[&#39;GridSearchCV RBF Kernel SVC&#39;, 0.94, 0.91, 0.87, 0.94, 0.9, 0.9, 0.88],
 [&#39;GridSearchCV RBF Kernel SVC With PCA transformed data&#39;,
  0.93,
  0.91,
  0.86,
  0.94,
  0.9,
  0.9,
  0.88]]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Comparing Standardized training data and PCA transformed training data, Recall is 0.87 when standardized training data is utilized and 0.86 when PCA transformed data is used. So, there is a reduction in Recall (Sensitivity) when PCA tranformed training data is used.</p>
<p>The rest of the other metric scores values for Specificity, Precision, Balanced Accuracy and F1-Score did not change.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Q8 [10]<a rel="noopener" class="anchor-link" href="#Q8-%5B10%5D">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>For regression:<ul>
<li>Think of other ways of improving the regression performance and list at least two possibilities.</li>
<li>You can use any of the datasets we have been using (standardized data, PCA transformed data), or re-create your own set from the original.</li>
<li>Implement both of the methods you proposed. </li>
<li>Is the validation performance increasing? For performance comparison you can use any regression performance metric that you deem to be appropriate. </li>
<li>Optional: Apply different methods, ideas as you see fit and see if the validation performance is improving.</li>
</ul>
</li>
</ul>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><b>Multicollinearity</b> could be one of the reasons why we are experiencing poor performance so we need to care of it by deriving a correlation matrix where we shall look at the relationships between the bivariant variables and also run VIF function where we shall exclude all those variables with VIF values exceeding 5.</p>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[127]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X_train_orig</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[127]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AT</th>
      <th>AP</th>
      <th>AH</th>
      <th>AFDP</th>
      <th>GTEP</th>
      <th>TIT</th>
      <th>TAT</th>
      <th>TEY</th>
      <th>CDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AT</th>
      <td>1.00</td>
      <td>-0.49</td>
      <td>-0.48</td>
      <td>0.47</td>
      <td>0.20</td>
      <td>0.33</td>
      <td>0.20</td>
      <td>0.11</td>
      <td>0.21</td>
    </tr>
    <tr>
      <th>AP</th>
      <td>-0.49</td>
      <td>1.00</td>
      <td>0.09</td>
      <td>-0.10</td>
      <td>-0.05</td>
      <td>-0.08</td>
      <td>-0.28</td>
      <td>0.04</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>AH</th>
      <td>-0.48</td>
      <td>0.09</td>
      <td>1.00</td>
      <td>-0.26</td>
      <td>-0.30</td>
      <td>-0.27</td>
      <td>0.03</td>
      <td>-0.19</td>
      <td>-0.23</td>
    </tr>
    <tr>
      <th>AFDP</th>
      <td>0.47</td>
      <td>-0.10</td>
      <td>-0.26</td>
      <td>1.00</td>
      <td>0.84</td>
      <td>0.91</td>
      <td>-0.52</td>
      <td>0.88</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>GTEP</th>
      <td>0.20</td>
      <td>-0.05</td>
      <td>-0.30</td>
      <td>0.84</td>
      <td>1.00</td>
      <td>0.89</td>
      <td>-0.62</td>
      <td>0.93</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>TIT</th>
      <td>0.33</td>
      <td>-0.08</td>
      <td>-0.27</td>
      <td>0.91</td>
      <td>0.89</td>
      <td>1.00</td>
      <td>-0.40</td>
      <td>0.95</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>TAT</th>
      <td>0.20</td>
      <td>-0.28</td>
      <td>0.03</td>
      <td>-0.52</td>
      <td>-0.62</td>
      <td>-0.40</td>
      <td>1.00</td>
      <td>-0.63</td>
      <td>-0.66</td>
    </tr>
    <tr>
      <th>TEY</th>
      <td>0.11</td>
      <td>0.04</td>
      <td>-0.19</td>
      <td>0.88</td>
      <td>0.93</td>
      <td>0.95</td>
      <td>-0.63</td>
      <td>1.00</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>CDP</th>
      <td>0.21</td>
      <td>0.02</td>
      <td>-0.23</td>
      <td>0.92</td>
      <td>0.94</td>
      <td>0.95</td>
      <td>-0.66</td>
      <td>0.99</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[128]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tcolumns</span> <span class="o">=</span> <span class="n">X_train_orig</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[129]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># create a correlation heatmap</span>
<span class="n">corrmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">X_train_orig</span><span class="p">[</span><span class="n">tcolumns</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="c1"># let&#39;s derive a transposed numpy array</span>
<span class="c1"># corrmat</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span> <span class="c1"># set the font</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">)})</span> <span class="c1"># set figure size</span>
<span class="n">hmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corrmat</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">tcolumns</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">tcolumns</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>From the above correlation matrix, we see that:
<li>GTEP and AFDP are highly correllated.</li>
<li>TEY and AFDP are highly correllated.</li>
<li>TIT and AFDP are highly correllated.</li>
<li>CDP and AFDP are highly correllated.</li>
<li>TIT and GTEP are highly correllated.</li>
<li>TEY and GTEP are highly correllated.</li>
<li>CDP and GTEP are highly correllated.</li>
<li>TEY and TIT are highly correllated.</li>
<li>TEY and CDP are highly correllated.</li>
<li>TIT and CDP are highly correllated.</li>
</ul>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Then using VIF, we need to exclude all those variables with high VIF values exceeding 5.</p>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[130]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[131]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># convert X_train into a pandas data frame</span>
<span class="n">df_X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AT&#39;</span><span class="p">,</span> <span class="s1">&#39;AP&#39;</span><span class="p">,</span> <span class="s1">&#39;AH&#39;</span><span class="p">,</span> <span class="s1">&#39;AFDP&#39;</span><span class="p">,</span> <span class="s1">&#39;GTEP&#39;</span><span class="p">,</span> <span class="s1">&#39;TIT&#39;</span><span class="p">,</span> <span class="s1">&#39;TAT&#39;</span><span class="p">,</span> <span class="s1">&#39;TEY&#39;</span><span class="p">,</span> <span class="s1">&#39;CDP&#39;</span><span class="p">])</span>
<span class="n">df_X_train_ver2</span> <span class="o">=</span> <span class="n">df_X_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1">#df_X_train </span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[132]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">df_X_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># make a copy of the origanl data set</span>
<span class="c1"># a helper function that returns the VIF values of the different features</span>
<span class="n">deriveVIF</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[132]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>VIF_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AT</td>
      <td>16.65754</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AP</td>
      <td>1.90902</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AH</td>
      <td>1.80366</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AFDP</td>
      <td>19.98047</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GTEP</td>
      <td>10.67075</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TIT</td>
      <td>841.20811</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TAT</td>
      <td>99.40907</td>
    </tr>
    <tr>
      <th>7</th>
      <td>TEY</td>
      <td>610.04739</td>
    </tr>
    <tr>
      <th>8</th>
      <td>CDP</td>
      <td>587.35429</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[133]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;TIT&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># drop the column from the pandas data frame</span>

<span class="c1"># a helper function that returns the VIF values of the different features</span>
<span class="n">deriveVIF</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[133]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>VIF_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AT</td>
      <td>11.16069</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AP</td>
      <td>1.73165</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AH</td>
      <td>1.78906</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AFDP</td>
      <td>18.95543</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GTEP</td>
      <td>10.45583</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TAT</td>
      <td>5.55776</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TEY</td>
      <td>297.15934</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CDP</td>
      <td>373.91661</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[134]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;TEY&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># drop the column from the pandas data frame</span>

<span class="c1"># a helper function that returns the VIF values of the different features</span>
<span class="n">deriveVIF</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[134]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>VIF_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AT</td>
      <td>4.80071</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AP</td>
      <td>1.59398</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AH</td>
      <td>1.76693</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AFDP</td>
      <td>18.95345</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GTEP</td>
      <td>10.41597</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TAT</td>
      <td>2.29871</td>
    </tr>
    <tr>
      <th>6</th>
      <td>CDP</td>
      <td>27.31655</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[135]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;CDP&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># drop the column from the pandas data frame</span>

<span class="c1"># a helper function that returns the VIF values of the different features</span>
<span class="n">deriveVIF</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[135]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>VIF_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AT</td>
      <td>3.89430</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AP</td>
      <td>1.59040</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AH</td>
      <td>1.74298</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AFDP</td>
      <td>7.45087</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GTEP</td>
      <td>5.99547</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TAT</td>
      <td>2.27982</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[136]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;AFDP&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># drop the column from the pandas data frame</span>

<span class="c1"># a helper function that returns the VIF values of the different features</span>
<span class="n">deriveVIF</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[136]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>VIF_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AT</td>
      <td>1.84906</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AP</td>
      <td>1.45290</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AH</td>
      <td>1.42961</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GTEP</td>
      <td>2.12599</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TAT</td>
      <td>2.12488</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[137]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[137]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AT</th>
      <th>AP</th>
      <th>AH</th>
      <th>GTEP</th>
      <th>TAT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AT</th>
      <td>1.00000</td>
      <td>-0.49000</td>
      <td>-0.48000</td>
      <td>0.20000</td>
      <td>0.20000</td>
    </tr>
    <tr>
      <th>AP</th>
      <td>-0.49000</td>
      <td>1.00000</td>
      <td>0.09000</td>
      <td>-0.05000</td>
      <td>-0.28000</td>
    </tr>
    <tr>
      <th>AH</th>
      <td>-0.48000</td>
      <td>0.09000</td>
      <td>1.00000</td>
      <td>-0.30000</td>
      <td>0.03000</td>
    </tr>
    <tr>
      <th>GTEP</th>
      <td>0.20000</td>
      <td>-0.05000</td>
      <td>-0.30000</td>
      <td>1.00000</td>
      <td>-0.62000</td>
    </tr>
    <tr>
      <th>TAT</th>
      <td>0.20000</td>
      <td>-0.28000</td>
      <td>0.03000</td>
      <td>-0.62000</td>
      <td>1.00000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Running the correlation matrix again:</p>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[138]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">tcolumns</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[139]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># create a correlation heatmap</span>
<span class="n">corrmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">tcolumns</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="c1"># let&#39;s derive a transposed numpy array</span>
<span class="c1"># corrmat</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span> <span class="c1"># set the font</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">)})</span> <span class="c1"># set figure size</span>
<span class="n">hmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corrmat</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">tcolumns</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">tcolumns</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">

<pre><code>- We can see that there is no more multicollinearity amongst the independent variables.</code></pre>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[140]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[140]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>Index([&#39;AT&#39;, &#39;AP&#39;, &#39;AH&#39;, &#39;GTEP&#39;, &#39;TAT&#39;], dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>Let&#39;s convert the transformed X_val into a data frame then use the Data frame to extract out the variables of interest which didn&#39;t have any collinearity amongst themselves</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[141]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_X_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AT&#39;</span><span class="p">,</span> <span class="s1">&#39;AP&#39;</span><span class="p">,</span> <span class="s1">&#39;AH&#39;</span><span class="p">,</span> <span class="s1">&#39;AFDP&#39;</span><span class="p">,</span> <span class="s1">&#39;GTEP&#39;</span><span class="p">,</span> <span class="s1">&#39;TIT&#39;</span><span class="p">,</span> <span class="s1">&#39;TAT&#39;</span><span class="p">,</span> <span class="s1">&#39;TEY&#39;</span><span class="p">,</span> <span class="s1">&#39;CDP&#39;</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[142]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_X_val</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># display the first 5 records</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[142]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AT</th>
      <th>AP</th>
      <th>AH</th>
      <th>AFDP</th>
      <th>GTEP</th>
      <th>TIT</th>
      <th>TAT</th>
      <th>TEY</th>
      <th>CDP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.42171</td>
      <td>0.23588</td>
      <td>0.78322</td>
      <td>-1.73708</td>
      <td>-1.09364</td>
      <td>-2.35257</td>
      <td>-1.24040</td>
      <td>-1.58392</td>
      <td>-1.43528</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.37048</td>
      <td>-0.78703</td>
      <td>0.68615</td>
      <td>0.18626</td>
      <td>-0.34035</td>
      <td>-0.02203</td>
      <td>0.64197</td>
      <td>-0.20474</td>
      <td>-0.30679</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.34982</td>
      <td>1.37404</td>
      <td>0.83823</td>
      <td>0.66399</td>
      <td>1.40485</td>
      <td>1.05244</td>
      <td>-2.22939</td>
      <td>1.71957</td>
      <td>1.57843</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.09037</td>
      <td>0.92742</td>
      <td>0.80918</td>
      <td>-1.65224</td>
      <td>-1.73201</td>
      <td>-1.77245</td>
      <td>0.31476</td>
      <td>-1.53823</td>
      <td>-1.57766</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.15291</td>
      <td>0.75454</td>
      <td>-0.13542</td>
      <td>1.05019</td>
      <td>1.12876</td>
      <td>1.02217</td>
      <td>-1.40401</td>
      <td>1.22507</td>
      <td>1.27433</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[143]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># extract out the variables of interest and create a new X_val data frame</span>
<span class="n">e_X_val</span> <span class="o">=</span> <span class="n">df_X_val</span><span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">e_X_train</span> <span class="o">=</span> <span class="n">ds</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[144]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">e_X_val</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># display the top 5 records</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[144]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AT</th>
      <th>AP</th>
      <th>AH</th>
      <th>GTEP</th>
      <th>TAT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.42171</td>
      <td>0.23588</td>
      <td>0.78322</td>
      <td>-1.09364</td>
      <td>-1.24040</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.37048</td>
      <td>-0.78703</td>
      <td>0.68615</td>
      <td>-0.34035</td>
      <td>0.64197</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.34982</td>
      <td>1.37404</td>
      <td>0.83823</td>
      <td>1.40485</td>
      <td>-2.22939</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.09037</td>
      <td>0.92742</td>
      <td>0.80918</td>
      <td>-1.73201</td>
      <td>0.31476</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.15291</td>
      <td>0.75454</td>
      <td>-0.13542</td>
      <td>1.12876</td>
      <td>-1.40401</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[145]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># display the top 5 records</span>
<span class="n">e_X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[145]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AT</th>
      <th>AP</th>
      <th>AH</th>
      <th>GTEP</th>
      <th>TAT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.67471</td>
      <td>1.48930</td>
      <td>-1.56867</td>
      <td>-0.34079</td>
      <td>0.63278</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.49278</td>
      <td>-0.16752</td>
      <td>-1.01861</td>
      <td>0.89150</td>
      <td>-0.39848</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.58082</td>
      <td>-1.17602</td>
      <td>0.91802</td>
      <td>-0.27772</td>
      <td>0.56477</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.32550</td>
      <td>-0.52770</td>
      <td>0.83999</td>
      <td>-0.48827</td>
      <td>0.67874</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.26948</td>
      <td>-1.27687</td>
      <td>-0.69614</td>
      <td>-0.44943</td>
      <td>0.69345</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>Let&#39;s build a linearRegression model</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[146]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># convert the pandas Data frames to numpy arrays</span>
<span class="n">e_X_train</span> <span class="o">=</span> <span class="n">e_X_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">e_X_val</span> <span class="o">=</span> <span class="n">e_X_val</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[147]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># initialize a Linear Regression object</span>
<span class="n">m_lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[148]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model on training data using the un correlated variables</span>
<span class="n">m_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">e_X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[148]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>LinearRegression()</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[149]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Linear Regression Performance Improvement With out multi-collinearity&#39;</span><span class="p">,</span><span class="n">m_lr</span><span class="p">,</span> <span class="n">e_X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">e_X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.545.
The model&#39;s R^2 on the validation data is 0.509.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.481.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.636.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[150]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the model&#39;s metrics to the list of regression models</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[151]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[151]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41),
 (&#39;Random Forest Regressor with PCA transformed data&#39;, 0.96, 0.74, 0.42, 1.2),
 (&#39;GridSearchCV Random Forest Regressor with PCA transformed data&#39;,
  0.8,
  0.75,
  0.98,
  1.17),
 (&#39;RBF Kernel SVR with PCA transformed data&#39;, 0.76, 0.75, 1.07, 1.17),
 (&#39;GridSearchCV RBF Kernel SVR with PCA transformed data&#39;,
  0.79,
  0.75,
  1.02,
  1.16),
 (&#39;Linear Regression Performance Improvement With out multi-collinearity&#39;,
  0.54,
  0.51,
  1.48,
  1.64)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>$R^2$ decreased on both training and validation so the model performance didn&#39;t improve, so we are going to experiment with the RandomForestRegressor.</p>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[152]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">m_rfr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[153]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># fit the model on the training un correlated data set.</span>
<span class="n">m_rfr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">e_X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[153]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>RandomForestRegressor(random_state=0)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[154]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Random Forest Regressor Performance Improvement With out multi-collinearity&#39;</span><span class="p">,</span><span class="n">m_rfr</span><span class="p">,</span> <span class="n">e_X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">e_X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.955.
The model&#39;s R^2 on the validation data is 0.701.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 0.465.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.277.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[155]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the model&#39;s metrics to the list of regression models</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[156]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[156]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41),
 (&#39;Random Forest Regressor with PCA transformed data&#39;, 0.96, 0.74, 0.42, 1.2),
 (&#39;GridSearchCV Random Forest Regressor with PCA transformed data&#39;,
  0.8,
  0.75,
  0.98,
  1.17),
 (&#39;RBF Kernel SVR with PCA transformed data&#39;, 0.76, 0.75, 1.07, 1.17),
 (&#39;GridSearchCV RBF Kernel SVR with PCA transformed data&#39;,
  0.79,
  0.75,
  1.02,
  1.16),
 (&#39;Linear Regression Performance Improvement With out multi-collinearity&#39;,
  0.54,
  0.51,
  1.48,
  1.64),
 (&#39;Random Forest Regressor Performance Improvement With out multi-collinearity&#39;,
  0.96,
  0.7,
  0.46,
  1.28)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Using RandomForestRegressor did not improve $R^2$ and RMSE on both training and validation data sets.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Linear Trees<a rel="noopener" class="anchor-link" href="#Linear-Trees">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>Here we shall explore a <strong>Linear Tree Regressor</strong> which is a meta-estimator that combines the learning ability of Decision Tree and the predictive power of linear models.</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[157]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">lineartree</span> <span class="kn">import</span> <span class="n">LinearTreeRegressor</span> <span class="c1">#, LinearForestRegressor, LinearBoostRegressor</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">ltr</span> <span class="o">=</span> <span class="n">LinearTreeRegressor</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[158]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ltr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[158]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>LinearTreeRegressor(base_estimator=LinearRegression(), criterion=&#39;rmse&#39;)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[159]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Linear Tree Regressor&#39;</span><span class="p">,</span><span class="n">ltr</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.774.
The model&#39;s R^2 on the validation data is 0.746.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.042.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.176.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[160]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the model&#39;s metrics to the list of regression models</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[161]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[161]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41),
 (&#39;Random Forest Regressor with PCA transformed data&#39;, 0.96, 0.74, 0.42, 1.2),
 (&#39;GridSearchCV Random Forest Regressor with PCA transformed data&#39;,
  0.8,
  0.75,
  0.98,
  1.17),
 (&#39;RBF Kernel SVR with PCA transformed data&#39;, 0.76, 0.75, 1.07, 1.17),
 (&#39;GridSearchCV RBF Kernel SVR with PCA transformed data&#39;,
  0.79,
  0.75,
  1.02,
  1.16),
 (&#39;Linear Regression Performance Improvement With out multi-collinearity&#39;,
  0.54,
  0.51,
  1.48,
  1.64),
 (&#39;Random Forest Regressor Performance Improvement With out multi-collinearity&#39;,
  0.96,
  0.7,
  0.46,
  1.28),
 (&#39;Linear Tree Regressor&#39;, 0.77, 0.75, 1.04, 1.18)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Using GridSearchCV<a rel="noopener" class="anchor-link" href="#Using-GridSearchCV">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[162]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span>  <span class="mi">120</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="s1">&#39;criterion&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="s1">&#39;rmse&#39;</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
    <span class="s1">&#39;max_bins&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">115</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[162]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;min_samples_split&#39;: [6, 120],
 &#39;min_samples_leaf&#39;: [10, 1000],
 &#39;criterion&#39;: [&#39;mse&#39;, &#39;rmse&#39;],
 &#39;max_depth&#39;: [5, 19],
 &#39;max_bins&#39;: [11, 115]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[163]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">lr</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">ltr_With_GridSearch</span> <span class="o">=</span> <span class="n">LinearTreeRegressor</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[164]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># helper function that takes an initialized algorithm object, parameters, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after performing a GridSearchCV and fitting a model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">deriveGridSearchCV</span><span class="p">(</span><span class="s1">&#39;Linear Tree Regressor With GridSearchCV&#39;</span><span class="p">,</span> <span class="n">ltr_With_GridSearch</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;criterion&#39;: &#39;mse&#39;, &#39;max_bins&#39;: 11, &#39;max_depth&#39;: 5, &#39;min_samples_leaf&#39;: 1000, &#39;min_samples_split&#39;: 6}



The model&#39;s R^2 on the training data set is 0.771.
The model&#39;s R^2 on the validation data set is 0.710.

The model&#39;s RMSE on the training data  is 1.049.
The model&#39;s RMSE on the training data  is 1.257.
Wall time: 4min 30s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[165]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s retrieve the best model and assign it to the variable</span>
<span class="n">ltr_With_GridSearch</span><span class="o">=</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[166]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples without the best model</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[167]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[167]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41),
 (&#39;Random Forest Regressor with PCA transformed data&#39;, 0.96, 0.74, 0.42, 1.2),
 (&#39;GridSearchCV Random Forest Regressor with PCA transformed data&#39;,
  0.8,
  0.75,
  0.98,
  1.17),
 (&#39;RBF Kernel SVR with PCA transformed data&#39;, 0.76, 0.75, 1.07, 1.17),
 (&#39;GridSearchCV RBF Kernel SVR with PCA transformed data&#39;,
  0.79,
  0.75,
  1.02,
  1.16),
 (&#39;Linear Regression Performance Improvement With out multi-collinearity&#39;,
  0.54,
  0.51,
  1.48,
  1.64),
 (&#39;Random Forest Regressor Performance Improvement With out multi-collinearity&#39;,
  0.96,
  0.7,
  0.46,
  1.28),
 (&#39;Linear Tree Regressor&#39;, 0.77, 0.75, 1.04, 1.18),
 (&#39;Linear Tree Regressor With GridSearchCV&#39;, 0.77, 0.71, 1.05, 1.26)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>We could also explore using <strong>regularization</strong> especially when several features are strongly correlated like in our case, so we shall use <strong>Elastic Net</strong> which is a combination of Ridge and Lasso regression.</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[168]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">ElasticNet</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[169]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">elasticNet_With_GridSearchCV</span> <span class="o">=</span> <span class="n">ElasticNet</span><span class="p">(</span><span class="n">selection</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:[</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">],</span>
           <span class="s1">&#39;l1_ratio&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.10</span> <span class="p">,</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span>
            <span class="s1">&#39;max_iter&#39;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span>
           <span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[169]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;alpha&#39;: [1e-05, 0.0001, 0.001, 0.01, 0.1, 1.0, 10.0, 100.0],
 &#39;l1_ratio&#39;: [0.1, 0.25, 0.5, 0.75],
 &#39;max_iter&#39;: [1000, 1500, 2000]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[170]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># helper function that takes an initialized algorithm object, parameters, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after performing a GridSearchCV and fitting a model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">deriveGridSearchCV</span><span class="p">(</span><span class="s1">&#39;ElasticNet With GridSearchCV&#39;</span><span class="p">,</span> <span class="n">elasticNet_With_GridSearchCV</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;alpha&#39;: 1e-05, &#39;l1_ratio&#39;: 0.1, &#39;max_iter&#39;: 2000}



The model&#39;s R^2 on the training data set is 0.664.
The model&#39;s R^2 on the validation data set is 0.646.

The model&#39;s RMSE on the training data  is 1.272.
The model&#39;s RMSE on the training data  is 1.388.
Wall time: 1.26 s
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>C:\Users\REJALU\.conda\envs\renv\lib\site-packages\sklearn\linear_model\_coordinate_descent.py:647: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 4.267e+03, tolerance: 2.560e+00
  model = cd_fast.enet_coordinate_descent(
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[171]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s retrieve the best model and assign it to the variable</span>
<span class="n">elasticNet_With_GridSearchCV</span> <span class="o">=</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[172]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples without the best model</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[173]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">regressionModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[173]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(&#39;Linear Regression&#39;, 0.66, 0.65, 1.27, 1.39),
 (&#39;Random Forest Regressor&#39;, 0.96, 0.76, 0.42, 1.15),
 (&#39;Random Forest Regressor with GridSearchCV&#39;, 0.79, 0.75, 1.0, 1.18),
 (&#39;Linear SVM Regressor&#39;, 0.62, 0.6, 1.34, 1.47),
 (&#39;Polynomial Kernel SVM Regressor&#39;, 0.74, 0.73, 1.12, 1.21),
 (&#39;RBF Kernel SVM Regressor&#39;, 0.77, 0.75, 1.06, 1.17),
 (&#39;RBF Kernel SVR with GridSearch&#39;, 0.79, 0.76, 1.0, 1.15),
 (&#39;Linear Regression with PCA transformed data&#39;, 0.66, 0.63, 1.29, 1.41),
 (&#39;Random Forest Regressor with PCA transformed data&#39;, 0.96, 0.74, 0.42, 1.2),
 (&#39;GridSearchCV Random Forest Regressor with PCA transformed data&#39;,
  0.8,
  0.75,
  0.98,
  1.17),
 (&#39;RBF Kernel SVR with PCA transformed data&#39;, 0.76, 0.75, 1.07, 1.17),
 (&#39;GridSearchCV RBF Kernel SVR with PCA transformed data&#39;,
  0.79,
  0.75,
  1.02,
  1.16),
 (&#39;Linear Regression Performance Improvement With out multi-collinearity&#39;,
  0.54,
  0.51,
  1.48,
  1.64),
 (&#39;Random Forest Regressor Performance Improvement With out multi-collinearity&#39;,
  0.96,
  0.7,
  0.46,
  1.28),
 (&#39;Linear Tree Regressor&#39;, 0.77, 0.75, 1.04, 1.18),
 (&#39;Linear Tree Regressor With GridSearchCV&#39;, 0.77, 0.71, 1.05, 1.26),
 (&#39;ElasticNet With GridSearchCV&#39;, 0.66, 0.65, 1.27, 1.39)]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>We could optimize our model by using <strong>Stochastic Gradient Descent Regressor</strong>, which fits a linear regressors under the convex loss functions.</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[174]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">### Using SGDRegressor</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;squared_error&#39;</span><span class="p">,</span> <span class="s1">&#39;huber&#39;</span><span class="p">,</span> <span class="s1">&#39;epsilon_insensitive&#39;</span><span class="p">,</span> <span class="s1">&#39;squared_epsilon_insensitive&#39;</span><span class="p">],</span> 
    <span class="s1">&#39;penalty&#39;</span><span class="p">:[</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="s1">&#39;elasticnet&#39;</span><span class="p">],</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">:[</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">],</span>
    <span class="s1">&#39;l1_ratio&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.10</span> <span class="p">,</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span>
    <span class="s1">&#39;max_iter&#39;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span>
    <span class="c1">#&#39;tol&#39;: [0.001, 0.009],</span>
    <span class="s1">&#39;learning_rate&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span><span class="s1">&#39;optimal&#39;</span><span class="p">,</span><span class="s1">&#39;invscaling&#39;</span><span class="p">,</span><span class="s1">&#39;adaptive&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[174]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;loss&#39;: [&#39;squared_error&#39;,
  &#39;huber&#39;,
  &#39;epsilon_insensitive&#39;,
  &#39;squared_epsilon_insensitive&#39;],
 &#39;penalty&#39;: [&#39;l2&#39;, &#39;l1&#39;, &#39;elasticnet&#39;],
 &#39;alpha&#39;: [1e-05, 0.0001, 0.001, 0.01, 0.1, 1.0, 10.0, 100.0],
 &#39;l1_ratio&#39;: [0.1, 0.25, 0.5, 0.75],
 &#39;max_iter&#39;: [1000, 1500, 2000],
 &#39;learning_rate&#39;: [&#39;constant&#39;, &#39;optimal&#39;, &#39;invscaling&#39;, &#39;adaptive&#39;]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[175]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sgd</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[176]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># helper function that takes an initialized algorithm object, parameters, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after performing a GridSearchCV and fitting a model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">deriveGridSearchCV</span><span class="p">(</span><span class="s1">&#39;Stochastic Gradient Descent With GridSearchCV&#39;</span><span class="p">,</span> <span class="n">sgd</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;alpha&#39;: 1e-05, &#39;l1_ratio&#39;: 0.5, &#39;learning_rate&#39;: &#39;adaptive&#39;, &#39;loss&#39;: &#39;squared_error&#39;, &#39;max_iter&#39;: 1000, &#39;penalty&#39;: &#39;l2&#39;}



The model&#39;s R^2 on the training data set is 0.664.
The model&#39;s R^2 on the validation data set is 0.647.

The model&#39;s RMSE on the training data  is 1.273.
The model&#39;s RMSE on the training data  is 1.388.
Wall time: 1min 31s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[177]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s retrieve the best model and assign it to the variable</span>
<span class="n">sgd_With_GridSearchCV</span><span class="o">=</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[178]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples without the best model</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Neither does $R^2$ nor $RMSE$ improve when we use the Stochastic Gradient Descent Regressor. </p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>We can also explore adding <strong>interaction terms</strong> to our data set.</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[179]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">inter_terms</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interaction_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train_inter</span> <span class="o">=</span> <span class="n">inter_terms</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_val_inter</span> <span class="o">=</span> <span class="n">inter_terms</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[180]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">lr_With_Inter_terms</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[181]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">lr_With_Inter_terms</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_inter</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[181]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>LinearRegression()</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[182]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># helper function that takes an initialized algorithm object, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after  deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">buildTheModel</span><span class="p">(</span><span class="s1">&#39;Linear Regression With interaction Terms&#39;</span><span class="p">,</span><span class="n">lr_With_Inter_terms</span><span class="p">,</span> <span class="n">X_train_inter</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val_inter</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.767.
The model&#39;s R^2 on the validation data is 0.741.

The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.060.
The model&#39;s Root Mean Squared Error (RMSE) on the validation data is 1.189.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[183]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the model&#39;s metrics to the list of regression models</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Adding Interaction terms improves $R^2$ and RMSE, however the RMSE values are still high. </p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>Let&#39;s perform a <strong>GridSearchCV</strong> to find the different hyper parameters, which can be used to fit on the transformed data set with <strong>interaction terms</strong>.</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[184]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>  
<span class="p">}</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[184]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;min_samples_split&#39;: [2, 20, 120],
 &#39;n_estimators&#39;: [100, 300, 600],
 &#39;max_depth&#39;: [10, 20, 50, 500]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[185]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># initialize a RandomForestRegressor object</span>
<span class="n">rfr_With_GSCV_inter_terms</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[186]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># helper function that takes an initialized algorithm object, parameters, training and validation sets and returns the model&#39;s metrics </span>
<span class="c1"># after performing a GridSearchCV and fitting a model on the training data, and also deriving the accuracy on both training and validation data.</span>
<span class="n">modelMetrics</span> <span class="o">=</span> <span class="n">deriveGridSearchCV</span><span class="p">(</span><span class="s1">&#39;Random Forest Regressor With GridSearchCV on Interaction terms&#39;</span><span class="p">,</span> <span class="n">rfr_With_GSCV_inter_terms</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train_inter</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_val_inter</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;max_depth&#39;: 50, &#39;min_samples_split&#39;: 20, &#39;n_estimators&#39;: 600}



The model&#39;s R^2 on the training data set is 0.917.
The model&#39;s R^2 on the validation data set is 0.753.

The model&#39;s RMSE on the training data  is 0.631.
The model&#39;s RMSE on the training data  is 1.161.
Wall time: 11min 49s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[187]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s retrieve the best model and assign it to the variable</span>
<span class="n">rfr_With_GSCV_inter_terms</span> <span class="o">=</span> <span class="n">modelMetrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[188]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># append the model metrics to the list of tuples without the best model</span>
<span class="n">regressionModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modelMetrics</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>$R^2$ increases on training and validation when you use the RandomForestRegressor and it is 0.92 and 0.75 respectively. These values are compared to $R^2$ on training and validation when Linear regression was used and the values are 0.77 and 0.74 respectively. Since there is a difference of 0.1 in the values of $R^2$ between training and validation when using RandomForestRegressor, which  means that these are the best scores we can get.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Q9 [10]<a rel="noopener" class="anchor-link" href="#Q9-%5B10%5D">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>For classification:<ul>
<li>Try at least one classifier other than SVM (RF, GBM, Logistic Regression, etc). </li>
<li>Think of other ways of improving the regression performance and list at least two possibilities.</li>
<li>You can use any of the datasets we have been using (standardized data, PCA transformed data), or re-create your own set from the original.</li>
<li>Implement both of the methods you proposed. </li>
<li>Is the validation performance increasing? For performance comparison you can use any regression performance metric that you deem to be appropriate. </li>
<li>Optional: Apply different methods, ideas as you see fit and see if the validation performance is improving.</li>
</ul>
</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[189]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Using RandomForestClassifier</span>
<span class="n">rf_classifier</span><span class="o">=</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[190]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># a helper function that returns the classifier&#39;s metrics after fitting the model and printing </span>
<span class="c1"># the classifier&#39;s metrics, confusion matrics and classification report </span>
<span class="n">classifier_metrics</span> <span class="o">=</span><span class="n">deriveClassifierObject</span><span class="p">(</span><span class="s1">&#39;Random Forest Classifier&#39;</span><span class="p">,</span><span class="n">rf_classifier</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val_cat</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s accuracy on training is : 1.0
The model&#39;s accuracy on validation is : 0.92

The Confusion Matrix is given below:
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
The classification report is given below:
              precision    recall  f1-score   support

         0.0       0.92      0.95      0.93       812
         1.0       0.91      0.86      0.89       517

    accuracy                           0.92      1329
   macro avg       0.92      0.91      0.91      1329
weighted avg       0.92      0.92      0.92      1329

Recall (Sensivity): 0.86
Specificity: 0.95
Precision: 0.91
Balanced Accuracy: 0.91
F1 Score: 0.89
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[191]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the list of the classifier metrics to the list of classification models</span>
<span class="n">classificationModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classifier_metrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[192]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">classificationModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[192]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[[&#39;GridSearchCV RBF Kernel SVC&#39;, 0.94, 0.91, 0.87, 0.94, 0.9, 0.9, 0.88],
 [&#39;GridSearchCV RBF Kernel SVC With PCA transformed data&#39;,
  0.93,
  0.91,
  0.86,
  0.94,
  0.9,
  0.9,
  0.88],
 [&#39;Random Forest Classifier&#39;, 1.0, 0.92, 0.86, 0.95, 0.91, 0.91, 0.89]]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The accuracy on training and validation is 1.0 and 0.92 respectively. There is a difference of 0.08 between the training and validation accuracy scores. The model slightly over fits on the training data. Also, the F1 Score is 0.89, Recall is 0.86 and Balanced Accuracy is 0.91. Overall, with a high Recall, F1-Score and Balanced Accuracy, the model is not performing poorly.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>With Random Forest:<a rel="noopener" class="anchor-link" href="#With-Random-Forest:">&#182;</a></h4>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>We try to decorrelate trees and increase variety between leaners by:<ul>
<li>decreasing the size of the bootstrap samples, which increases diversity among trees and also increases the randomness of the random forest, which helps in reducing overfitting.</li>
<li>randomly selecting a small number of features which decreases the chance of over-selecting the same feature.</li>
</ul>
</li>
</ul>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h5>first, let&#39;s use GridSearchCV to find a combination of different hyper-parameters to use:<a rel="noopener" class="anchor-link" href="#first,-let&#39;s-use-GridSearchCV-to-find-a-combination-of-different-hyper-parameters-to-use:">&#182;</a></h5>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[193]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
<span class="n">min_samples_split</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span>  <span class="mi">200</span><span class="p">],</span>
<span class="n">max_depth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1200</span><span class="p">],</span>
<span class="n">max_features</span><span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="n">bootstrap</span><span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="n">n_estimators</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">600</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[193]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;min_samples_leaf&#39;: [5, 500],
 &#39;min_samples_split&#39;: [5, 200],
 &#39;max_depth&#39;: [5, 500, 1200],
 &#39;max_features&#39;: [6, 7, 8, 9],
 &#39;bootstrap&#39;: [True, False],
 &#39;n_estimators&#39;: [50, 600]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[194]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s initialize a RandomForestClassifier Object</span>
<span class="n">rf_classifier_With_GridSearchCV</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[195]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># A helper function that returns the model&#39;s prediction accuracy on training and validation data </span>
<span class="c1"># after performing GridSearchCv to tune the different hyperparameters which it uses to fit the model </span>
<span class="c1"># and also prints the different metrics</span>
<span class="n">classifier_metrics</span><span class="p">,</span> <span class="n">rf_classifier_With_GridSearchCV</span> <span class="o">=</span> <span class="n">classGridSearchCV</span><span class="p">(</span><span class="s1">&#39;Random Forest Classifier With Grid SearchCV&#39;</span><span class="p">,</span> <span class="n">rf_classifier_With_GridSearchCV</span> <span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;bootstrap&#39;: True, &#39;max_depth&#39;: 500, &#39;max_features&#39;: 8, &#39;min_samples_leaf&#39;: 5, &#39;min_samples_split&#39;: 5, &#39;n_estimators&#39;: 600}



The model&#39;s accuracy on training is : 0.96
The model&#39;s accuracy on validation is : 0.92

The Confusion Matrix is given below:
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
The classification report is given below:
              precision    recall  f1-score   support

         0.0       0.92      0.95      0.93       812
         1.0       0.91      0.87      0.89       517

    accuracy                           0.92      1329
   macro avg       0.92      0.91      0.91      1329
weighted avg       0.92      0.92      0.92      1329

Recall (Sensivity): 0.87
Specificity: 0.95
Precision: 0.91
Balanced Accuracy: 0.91
F1 Score: 0.89
Wall time: 13min 35s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[196]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># return the best estimator that was chosen by the gridsearch</span>
<span class="n">rf_classifier_With_GridSearchCV</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[196]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>RandomForestClassifier(max_depth=500, max_features=8, min_samples_leaf=5,
                       min_samples_split=5, n_estimators=600, random_state=0)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[197]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the list of the classifier metrics to the list of classification models</span>
<span class="n">classificationModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classifier_metrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[198]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">classificationModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[198]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[[&#39;GridSearchCV RBF Kernel SVC&#39;, 0.94, 0.91, 0.87, 0.94, 0.9, 0.9, 0.88],
 [&#39;GridSearchCV RBF Kernel SVC With PCA transformed data&#39;,
  0.93,
  0.91,
  0.86,
  0.94,
  0.9,
  0.9,
  0.88],
 [&#39;Random Forest Classifier&#39;, 1.0, 0.92, 0.86, 0.95, 0.91, 0.91, 0.89],
 [&#39;Random Forest Classifier With Grid SearchCV&#39;,
  0.96,
  0.92,
  0.87,
  0.95,
  0.91,
  0.91,
  0.89]]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>let&#39;s plot a bar chat showing us the features of importance for a Random Forest Classifier<a rel="noopener" class="anchor-link" href="#let&#39;s-plot-a-bar-chat-showing-us-the-features-of-importance-for-a-Random-Forest-Classifier">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[199]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model_type</span> <span class="o">=</span> <span class="s1">&#39;rfc&#39;</span> 
<span class="n">model_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rfc&#39;</span><span class="p">:</span><span class="n">rf_classifier_With_GridSearchCV</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">}</span>
<span class="n">importances</span> <span class="o">=</span> <span class="n">model_dict</span><span class="p">[</span><span class="n">model_type</span><span class="p">]</span>
<span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">importances</span><span class="p">))</span> 
<span class="n">feature_names</span><span class="o">=</span><span class="n">df_X_train</span><span class="o">.</span><span class="n">columns</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">importances</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">xticklabel_rotation</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">xticklabel_rotation</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Feature Importance: Random Forest Classifier&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Here, we learn that AFDP, TIT, AT, GTEP and AP are the most significant features.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Accuracy on training and validation is 0.96 and 0.92 respectively. Also, tuning Random Forest Classifier with the perfect hyper parameters reduces the model&#39;s overfitting on the training data since there is a difference of 0.04 between training and validation accuracy which is less than the value of 0.08 we were seeing before.</p>
<p>Furthermore, Recall increased from 0.86 to 0.87, Balanced Accuracy remained at 0.91 and the F1-Score remained at 0.89.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>With GradientBoosting Classifier<a rel="noopener" class="anchor-link" href="#With-GradientBoosting-Classifier">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>We shall subsample rows, columns before creating trees like in Random Forests.</li>
<li>We shall also tune the number of trees, tree depth, number of points in the leaves and the number of observations per split. </li>
</ul>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>we check for a combination of different parameters using GridSearchCV<a rel="noopener" class="anchor-link" href="#we-check-for-a-combination-of-different-parameters-using-GridSearchCV">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[200]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">learning_rate</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">],</span>
    <span class="n">n_estimators</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="n">max_depth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span>  <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="n">min_samples_split</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="n">subsample</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">],</span>
    <span class="n">max_features</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> 
<span class="p">)</span>
<span class="n">parameters</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[200]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>{&#39;learning_rate&#39;: [1.0, 8.0],
 &#39;n_estimators&#39;: [50, 500],
 &#39;max_depth&#39;: [5, 100, 500],
 &#39;min_samples_split&#39;: [100, 500],
 &#39;subsample&#39;: [0.6, 0.9],
 &#39;max_features&#39;: [6, 7, 8, 9]}</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[201]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># initialize the GradientBoostingClassifier object</span>
<span class="n">gb_classifier_With_GridSearchCV</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[202]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># A helper function that returns the model&#39;s prediction accuracy on training and validation data </span>
<span class="c1"># after performing GridSearchCv to tune the different hyperparameters which it uses to fit the model </span>
<span class="c1"># and also prints the different metrics</span>
<span class="n">classifier_metrics</span><span class="p">,</span> <span class="n">gb_classifier_With_GridSearchCV</span> <span class="o">=</span> <span class="n">classGridSearchCV</span><span class="p">(</span><span class="s1">&#39;Gradient Boosting Classifier With Grid SearchCV&#39;</span><span class="p">,</span> <span class="n">gb_classifier_With_GridSearchCV</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>BEST PARAMS: {&#39;learning_rate&#39;: 1.0, &#39;max_depth&#39;: 5, &#39;max_features&#39;: 9, &#39;min_samples_split&#39;: 100, &#39;n_estimators&#39;: 50, &#39;subsample&#39;: 0.9}



The model&#39;s accuracy on training is : 0.99
The model&#39;s accuracy on validation is : 0.89

The Confusion Matrix is given below:
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
The classification report is given below:
              precision    recall  f1-score   support

         0.0       0.90      0.92      0.91       812
         1.0       0.88      0.84      0.86       517

    accuracy                           0.89      1329
   macro avg       0.89      0.88      0.89      1329
weighted avg       0.89      0.89      0.89      1329

Recall (Sensivity): 0.84
Specificity: 0.92
Precision: 0.88
Balanced Accuracy: 0.88
F1 Score: 0.86
Wall time: 15min 21s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[203]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># this is our best model</span>
<span class="n">gb_classifier_With_GridSearchCV</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[203]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>GradientBoostingClassifier(learning_rate=1.0, max_depth=5, max_features=9,
                           min_samples_split=100, n_estimators=50,
                           random_state=0, subsample=0.9)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[204]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the list of the classifier metrics to the list of classification models</span>
<span class="n">classificationModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classifier_metrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[205]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">classificationModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[205]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[[&#39;GridSearchCV RBF Kernel SVC&#39;, 0.94, 0.91, 0.87, 0.94, 0.9, 0.9, 0.88],
 [&#39;GridSearchCV RBF Kernel SVC With PCA transformed data&#39;,
  0.93,
  0.91,
  0.86,
  0.94,
  0.9,
  0.9,
  0.88],
 [&#39;Random Forest Classifier&#39;, 1.0, 0.92, 0.86, 0.95, 0.91, 0.91, 0.89],
 [&#39;Random Forest Classifier With Grid SearchCV&#39;,
  0.96,
  0.92,
  0.87,
  0.95,
  0.91,
  0.91,
  0.89],
 [&#39;Gradient Boosting Classifier With Grid SearchCV&#39;,
  0.99,
  0.89,
  0.84,
  0.92,
  0.88,
  0.88,
  0.86]]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The accuracy on Training and validation is 0.99 and 0.89 respectively. Recall, F1-Score and Balanced Accuracy are 0.84, 0.86 and 0.88 respectively. So, using GradientBoost Classifier didn&#39;t improve performance on validation.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>With Voting Classifier with Hard Voting:<a rel="noopener" class="anchor-link" href="#With-Voting-Classifier-with-Hard-Voting:">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>Voting classifier with hard voting allows us to combine different classification algorithms with a goal of building a strong meta-classifier that balances out the individual classifier&#39;s weakness on this data set.</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[206]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clf1</span><span class="o">=</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">clf2</span><span class="o">=</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">clf3</span><span class="o">=</span><span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[207]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pred_val_acc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pred_train_acc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">eclf</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">clf1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;rfr&#39;</span><span class="p">,</span> <span class="n">clf2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;gboost&#39;</span><span class="p">,</span> <span class="n">clf3</span><span class="p">)],</span> <span class="n">voting</span><span class="o">=</span><span class="s1">&#39;hard&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">clf</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">,</span> <span class="n">clf3</span><span class="p">,</span> <span class="n">eclf</span><span class="p">],</span> 
                      <span class="p">[</span><span class="s1">&#39;Logistic Regression&#39;</span><span class="p">,</span> <span class="s1">&#39;Random Forest&#39;</span><span class="p">,</span> <span class="s1">&#39;Gradient Boosting&#39;</span><span class="p">,</span> <span class="s1">&#39;Ensemble&#39;</span><span class="p">]):</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>
    <span class="n">pred_train_acc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_val_predict</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">))</span>
    <span class="n">pred_val_acc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_val_predict</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val_cat</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Validation Accuracy: </span><span class="si">%0.5f</span><span class="s2"> (+/- </span><span class="si">%0.3f</span><span class="s2">) [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">label</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Validation Accuracy: 0.86969 (+/- 0.024) [Logistic Regression]
Validation Accuracy: 0.87540 (+/- 0.036) [Random Forest]
Validation Accuracy: 0.86943 (+/- 0.038) [Gradient Boosting]
Validation Accuracy: 0.87777 (+/- 0.033) [Ensemble]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[208]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pred_train_acc</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[208]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[array([1., 0., 0., ..., 1., 1., 0.]),
 array([0., 0., 0., ..., 1., 1., 0.]),
 array([0., 0., 0., ..., 1., 1., 0.]),
 array([0., 0., 0., ..., 1., 1., 0.])]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[209]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pred_train_calc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">pred_train_item</span> <span class="ow">in</span> <span class="n">pred_train_acc</span><span class="p">:</span>
    <span class="c1"># calculate the total accuracy on training</span>
    <span class="n">pred_train_calc</span> <span class="o">+=</span> <span class="n">pred_train_item</span>

<span class="c1"># derive the average of the total accuracy on training.</span>
<span class="n">pred_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_train_calc</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_train_acc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[210]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pred_val_acc</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[210]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[array([1., 0., 0., ..., 1., 1., 1.]),
 array([1., 0., 0., ..., 1., 0., 1.]),
 array([1., 0., 0., ..., 1., 0., 1.]),
 array([1., 0., 0., ..., 1., 0., 1.])]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[211]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pred_vote_calc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">pred_val</span> <span class="ow">in</span> <span class="n">pred_val_acc</span><span class="p">:</span>
    <span class="c1"># calculate the total accuracy on validation</span>
    <span class="n">pred_vote_calc</span> <span class="o">+=</span> <span class="n">pred_val</span>

<span class="c1"># derive the average of the total accuracy on validation.</span>
<span class="n">pred_vote</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_vote_calc</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_val_acc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[212]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pred_vote</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[212]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([1, 0, 0, ..., 1, 0, 1])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[213]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Dynamically calculating Recall(Sensitivity), Specificity, Precision, Balanced Accuracy and F1-Score</span>
<span class="n">TN</span><span class="p">,</span> <span class="n">FP</span><span class="p">,</span> <span class="n">FN</span><span class="p">,</span> <span class="n">TP</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">pred_vote</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="c1"># return the elements of the matrix as array</span>

<span class="n">Specificity</span> <span class="o">=</span> <span class="n">TN</span><span class="o">/</span><span class="p">(</span><span class="n">TN</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span>

<span class="n">Precision</span> <span class="o">=</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span>

<span class="n">Recall</span> <span class="o">=</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span>

<span class="n">F1Score</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Precision</span> <span class="o">*</span> <span class="n">Recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Precision</span> <span class="o">+</span> <span class="n">Recall</span><span class="p">))</span>

<span class="n">BalancedAccuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">Recall</span>  <span class="o">+</span> <span class="n">Specificity</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall (Sensivity): </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">Recall</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Specificity: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">Specificity</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Precision: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">Precision</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Balanced Accuracy: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">BalancedAccuracy</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;F1 Score: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">F1Score</span><span class="p">))))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Recall (Sensivity): 0.85
Specificity: 0.95
Precision: 0.91
Balanced Accuracy: 0.9
F1 Score: 0.88
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[214]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">votingClassifierMetrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Voting Classifier With Hard voting&#39;</span><span class="p">,</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train_cat</span><span class="p">,</span> <span class="n">pred_train</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val_cat</span><span class="p">,</span> <span class="n">pred_vote</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">Recall</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">Specificity</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">Precision</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">BalancedAccuracy</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">F1Score</span><span class="p">)]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[215]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add the list of the classifier metrics to the list of classification models</span>
<span class="n">classificationModels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">votingClassifierMetrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[216]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">classificationModels</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[216]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[[&#39;GridSearchCV RBF Kernel SVC&#39;, 0.94, 0.91, 0.87, 0.94, 0.9, 0.9, 0.88],
 [&#39;GridSearchCV RBF Kernel SVC With PCA transformed data&#39;,
  0.93,
  0.91,
  0.86,
  0.94,
  0.9,
  0.9,
  0.88],
 [&#39;Random Forest Classifier&#39;, 1.0, 0.92, 0.86, 0.95, 0.91, 0.91, 0.89],
 [&#39;Random Forest Classifier With Grid SearchCV&#39;,
  0.96,
  0.92,
  0.87,
  0.95,
  0.91,
  0.91,
  0.89],
 [&#39;Gradient Boosting Classifier With Grid SearchCV&#39;,
  0.99,
  0.89,
  0.84,
  0.92,
  0.88,
  0.88,
  0.86],
 [&#39;Voting Classifier With Hard voting&#39;,
  0.92,
  0.91,
  0.85,
  0.95,
  0.91,
  0.9,
  0.88]]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Here, we can see that the performance of the voting classifier with hard voting improves over the individual classifier in the 10 fold cross validation evaluation.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Q10 [10]<a rel="noopener" class="anchor-link" href="#Q10-%5B10%5D">&#182;</a></h2>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>Choose the best 2 regressors among the trained regressions models:</li>
<li>Create a table summarizing results on the <strong>test</strong> set for regression (with target variables in <code>y_test</code>):<ul>
<li>Show the R^2 and RMSE performance metrics on test data for each model.</li>
</ul>
</li>
<li>Which model is best for regression? Is this in line with your analysis (the validation performance of the models) or is this not expected?</li>
</ul>
<ul>
<li>Choose the best 2 classifiers among the trained classification models:</li>
<li>Create a table summarizing results on the <strong>test</strong> set for classification (with target variables in <code>y_test_cat</code>):<ul>
<li>Show the classification performance metrics (accuracy, recall, precision, f1-score, etc.) on test data for each model. </li>
</ul>
</li>
<li>Which model is best for classification? Is this in line with your analysis (the validation performance of the models) or is this not expected? </li>
</ul>
<blockquote><p>Note that the same transformation used during training should be applied on the testing set. (If you applied PCA on training data for the selected model, you need to apply PCA on the testing set as well.)</p>
</blockquote>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>First, let&#39;s convert the list of tuples for regression models into a panda data frame.</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[217]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[218]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s format the diaply to have two decimal places</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span>  <span class="s1">&#39;</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[219]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># converting the list of tuples into a pandas data frame</span>
<span class="n">df_regressors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">regressionModels</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Model Name&#39;</span><span class="p">,</span> <span class="s1">&#39;R Squared on Training&#39;</span><span class="p">,</span> <span class="s1">&#39;R Squared on Validation&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE on training&#39;</span><span class="p">,</span>  <span class="s1">&#39;RMSE on validation&#39;</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[220]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s calculate the difference between R Squared training and validation</span>
<span class="n">df_regressors</span><span class="p">[</span><span class="s1">&#39;R Squared difference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_regressors</span><span class="p">[</span><span class="s1">&#39;R Squared on Training&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_regressors</span><span class="p">[</span><span class="s1">&#39;R Squared on Validation&#39;</span><span class="p">]</span>
<span class="n">df_regressors</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[220]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model Name</th>
      <th>R Squared on Training</th>
      <th>R Squared on Validation</th>
      <th>RMSE on training</th>
      <th>RMSE on validation</th>
      <th>R Squared difference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Linear Regression</td>
      <td>0.66</td>
      <td>0.65</td>
      <td>1.27</td>
      <td>1.39</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest Regressor</td>
      <td>0.96</td>
      <td>0.76</td>
      <td>0.42</td>
      <td>1.15</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Random Forest Regressor with GridSearchCV</td>
      <td>0.79</td>
      <td>0.75</td>
      <td>1.00</td>
      <td>1.18</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear SVM Regressor</td>
      <td>0.62</td>
      <td>0.60</td>
      <td>1.34</td>
      <td>1.47</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Polynomial Kernel SVM Regressor</td>
      <td>0.74</td>
      <td>0.73</td>
      <td>1.12</td>
      <td>1.21</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5</th>
      <td>RBF Kernel SVM Regressor</td>
      <td>0.77</td>
      <td>0.75</td>
      <td>1.06</td>
      <td>1.17</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>6</th>
      <td>RBF Kernel SVR with GridSearch</td>
      <td>0.79</td>
      <td>0.76</td>
      <td>1.00</td>
      <td>1.15</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Linear Regression with PCA transformed data</td>
      <td>0.66</td>
      <td>0.63</td>
      <td>1.29</td>
      <td>1.41</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Random Forest Regressor with PCA transformed data</td>
      <td>0.96</td>
      <td>0.74</td>
      <td>0.42</td>
      <td>1.20</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>9</th>
      <td>GridSearchCV Random Forest Regressor with PCA ...</td>
      <td>0.80</td>
      <td>0.75</td>
      <td>0.98</td>
      <td>1.17</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>10</th>
      <td>RBF Kernel SVR with PCA transformed data</td>
      <td>0.76</td>
      <td>0.75</td>
      <td>1.07</td>
      <td>1.17</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>11</th>
      <td>GridSearchCV RBF Kernel SVR with PCA transform...</td>
      <td>0.79</td>
      <td>0.75</td>
      <td>1.02</td>
      <td>1.16</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Linear Regression Performance Improvement With...</td>
      <td>0.54</td>
      <td>0.51</td>
      <td>1.48</td>
      <td>1.64</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Random Forest Regressor Performance Improvemen...</td>
      <td>0.96</td>
      <td>0.70</td>
      <td>0.46</td>
      <td>1.28</td>
      <td>0.26</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Linear Tree Regressor</td>
      <td>0.77</td>
      <td>0.75</td>
      <td>1.04</td>
      <td>1.18</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Linear Tree Regressor With GridSearchCV</td>
      <td>0.77</td>
      <td>0.71</td>
      <td>1.05</td>
      <td>1.26</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ElasticNet With GridSearchCV</td>
      <td>0.66</td>
      <td>0.65</td>
      <td>1.27</td>
      <td>1.39</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Stochastic Gradient Descent With GridSearchCV</td>
      <td>0.66</td>
      <td>0.65</td>
      <td>1.27</td>
      <td>1.39</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Linear Regression With interaction Terms</td>
      <td>0.77</td>
      <td>0.74</td>
      <td>1.06</td>
      <td>1.19</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Random Forest Regressor With GridSearchCV on I...</td>
      <td>0.92</td>
      <td>0.75</td>
      <td>0.63</td>
      <td>1.16</td>
      <td>0.17</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[221]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s sort the data frame by the difference between R Squared on training and validation, R Squared on Training, R Squared on Validation, then RMSE on training and RMSE on validation</span>
<span class="n">df_regressors_sorted</span> <span class="o">=</span> <span class="n">df_regressors</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R Squared difference&#39;</span><span class="p">,</span> <span class="s1">&#39;R Squared on Training&#39;</span><span class="p">,</span> <span class="s1">&#39;R Squared on Validation&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE on training&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE on validation&#39;</span><span class="p">])</span>
<span class="n">df_regressors_sorted</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[221]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model Name</th>
      <th>R Squared on Training</th>
      <th>R Squared on Validation</th>
      <th>RMSE on training</th>
      <th>RMSE on validation</th>
      <th>R Squared difference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Linear Regression</td>
      <td>0.66</td>
      <td>0.65</td>
      <td>1.27</td>
      <td>1.39</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ElasticNet With GridSearchCV</td>
      <td>0.66</td>
      <td>0.65</td>
      <td>1.27</td>
      <td>1.39</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Stochastic Gradient Descent With GridSearchCV</td>
      <td>0.66</td>
      <td>0.65</td>
      <td>1.27</td>
      <td>1.39</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Polynomial Kernel SVM Regressor</td>
      <td>0.74</td>
      <td>0.73</td>
      <td>1.12</td>
      <td>1.21</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>10</th>
      <td>RBF Kernel SVR with PCA transformed data</td>
      <td>0.76</td>
      <td>0.75</td>
      <td>1.07</td>
      <td>1.17</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Linear SVM Regressor</td>
      <td>0.62</td>
      <td>0.60</td>
      <td>1.34</td>
      <td>1.47</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Linear Tree Regressor</td>
      <td>0.77</td>
      <td>0.75</td>
      <td>1.04</td>
      <td>1.18</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>5</th>
      <td>RBF Kernel SVM Regressor</td>
      <td>0.77</td>
      <td>0.75</td>
      <td>1.06</td>
      <td>1.17</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Linear Regression Performance Improvement With...</td>
      <td>0.54</td>
      <td>0.51</td>
      <td>1.48</td>
      <td>1.64</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Linear Regression with PCA transformed data</td>
      <td>0.66</td>
      <td>0.63</td>
      <td>1.29</td>
      <td>1.41</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Linear Regression With interaction Terms</td>
      <td>0.77</td>
      <td>0.74</td>
      <td>1.06</td>
      <td>1.19</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>6</th>
      <td>RBF Kernel SVR with GridSearch</td>
      <td>0.79</td>
      <td>0.76</td>
      <td>1.00</td>
      <td>1.15</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Random Forest Regressor with GridSearchCV</td>
      <td>0.79</td>
      <td>0.75</td>
      <td>1.00</td>
      <td>1.18</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>11</th>
      <td>GridSearchCV RBF Kernel SVR with PCA transform...</td>
      <td>0.79</td>
      <td>0.75</td>
      <td>1.02</td>
      <td>1.16</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>9</th>
      <td>GridSearchCV Random Forest Regressor with PCA ...</td>
      <td>0.80</td>
      <td>0.75</td>
      <td>0.98</td>
      <td>1.17</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Linear Tree Regressor With GridSearchCV</td>
      <td>0.77</td>
      <td>0.71</td>
      <td>1.05</td>
      <td>1.26</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Random Forest Regressor With GridSearchCV on I...</td>
      <td>0.92</td>
      <td>0.75</td>
      <td>0.63</td>
      <td>1.16</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest Regressor</td>
      <td>0.96</td>
      <td>0.76</td>
      <td>0.42</td>
      <td>1.15</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Random Forest Regressor with PCA transformed data</td>
      <td>0.96</td>
      <td>0.74</td>
      <td>0.42</td>
      <td>1.20</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Random Forest Regressor Performance Improvemen...</td>
      <td>0.96</td>
      <td>0.70</td>
      <td>0.46</td>
      <td>1.28</td>
      <td>0.26</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>The best regressors are:
    <li>RBF Kernel SVR with PCA transformed data.</li>
    <li>RBF Kernel SVR Regressor with GridSearch.</li>
</ul><p>I chose these two regressors because they have the highest $R^2$ on the validation data but also keeping mind the smallest differences in the R Squared value between training and validation.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Using the RBF Kernel SVR with PCA transformed data<a rel="noopener" class="anchor-link" href="#Using-the-RBF-Kernel-SVR-with-PCA-transformed-data">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[222]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># output the model&#39;s prediction on the test set.</span>
<span class="n">pred_test_rbf</span> <span class="o">=</span> <span class="n">rbf_K_SVR_With_PCA_transformed_data</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_pca2</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[223]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># R^2 on the testing data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s R^2 on the training data is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRSquared</span>(y_test, pred_test_rbf))
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.589.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[224]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Root Mean Squared Error (RMSE) on testing data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s Root Mean Squared Error (RMSE) on the training data is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRMSE</span>(y_test, pred_test_rbf))
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.496.
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Using RBF Kernel SVR Regressor with GridSearch<a rel="noopener" class="anchor-link" href="#Using-RBF-Kernel-SVR-Regressor-with-GridSearch">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[225]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># output the model&#39;s prediction on the test set.</span>
<span class="n">pred_test</span> <span class="o">=</span> <span class="n">gridSCV_rbf_K_SVR</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[226]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># R^2 on the testing data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s R^2 on the training data is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRSquared</span>(y_test, pred_test))
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s R^2 on the training data is 0.576.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[227]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Root Mean Squared Error (RMSE) on testing data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The model&#39;s Root Mean Squared Error (RMSE) on the training data is </span><span class="si">%.3f</span><span class="s2">.&quot;</span> <span class="o">%</span><span class="k">deriveRMSE</span>(y_test, pred_test))
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The model&#39;s Root Mean Squared Error (RMSE) on the training data is 1.519.
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[228]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s create a list of RSquared values</span>
<span class="n">listOfRSquared</span><span class="o">=</span><span class="p">[</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRSquared</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_test_rbf</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRSquared</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_test</span><span class="p">))</span> <span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[229]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s create a list of RMSE values of the two best regression models</span>
<span class="n">listOfRMSE</span> <span class="o">=</span><span class="p">[</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRMSE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_test_rbf</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">deriveRMSE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_test</span><span class="p">))]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>let&#39;s create a table summarizing the results on the test set for regression.<a rel="noopener" class="anchor-link" href="#let&#39;s-create-a-table-summarizing-the-results-on-the-test-set-for-regression.">&#182;</a></h3>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[230]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#let&#39;s create a mask for the best two regressors.</span>
<span class="n">condition_mask</span> <span class="o">=</span> <span class="n">df_regressors_sorted</span><span class="p">[</span><span class="s1">&#39;Model Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;RBF Kernel SVR with PCA transformed data&#39;</span><span class="p">,</span> <span class="s1">&#39;RBF Kernel SVR with GridSearch&#39;</span><span class="p">])</span>
<span class="n">df_best_linear_models</span> <span class="o">=</span> <span class="n">df_regressors_sorted</span><span class="p">[</span><span class="n">condition_mask</span><span class="p">]</span>
<span class="c1"># create a copy of the data set</span>
<span class="n">df_best_linear_m_final</span> <span class="o">=</span> <span class="n">df_best_linear_models</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1">#df_best_linear_m_final</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[231]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_best_linear_m_final</span><span class="p">[</span><span class="s1">&#39;R Squared on testing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">listOfRSquared</span>
<span class="n">df_best_linear_m_final</span><span class="p">[</span><span class="s1">&#39;RMSE on testing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">listOfRMSE</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[232]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># display the items of the data set</span>
<span class="n">df_best_linear_m_final</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[232]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model Name</th>
      <th>R Squared on Training</th>
      <th>R Squared on Validation</th>
      <th>RMSE on training</th>
      <th>RMSE on validation</th>
      <th>R Squared difference</th>
      <th>R Squared on testing</th>
      <th>RMSE on testing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>RBF Kernel SVR with PCA transformed data</td>
      <td>0.76</td>
      <td>0.75</td>
      <td>1.07</td>
      <td>1.17</td>
      <td>0.01</td>
      <td>0.59</td>
      <td>1.50</td>
    </tr>
    <tr>
      <th>6</th>
      <td>RBF Kernel SVR with GridSearch</td>
      <td>0.79</td>
      <td>0.76</td>
      <td>1.00</td>
      <td>1.15</td>
      <td>0.03</td>
      <td>0.58</td>
      <td>1.52</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>From the above table, <b>RBF Kernel Support Vector Regressor build with PCA transformed data</b> is the best model since PCA eliminates multicollinearity between features by combining highly correlated variables into a set of un correlated variables and this is the situation we are in since our data has a lot of strongly correlated variables. Also, it has the highest $R^2$ of 0.59 and lower RMSE of 1.50 on testing.</p> <p>Furthermore, for the second best model, <b>RBF Kernel SVR with GridSearch</b> increased $R^2$, which was part of the validation performance of the model in Question 5.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Before choosing the best 2 classifiers among the trained classification models, we need to convert the list of classification models into pandas.<a rel="noopener" class="anchor-link" href="#Before-choosing-the-best-2-classifiers-among-the-trained-classification-models,-we-need-to-convert-the-list-of-classification-models-into-pandas.">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[233]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_classifiers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">classificationModels</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ModelName&#39;</span><span class="p">,</span> <span class="s1">&#39;AccuracyOnTraining&#39;</span><span class="p">,</span> <span class="s1">&#39;AccuracyOnval&#39;</span><span class="p">,</span> <span class="s1">&#39;RecallOnVal&#39;</span><span class="p">,</span> <span class="s1">&#39;SpecificityOnVal&#39;</span><span class="p">,</span> <span class="s1">&#39;PrecisionOnVal&#39;</span><span class="p">,</span> <span class="s1">&#39;BalancedAccuracyOnVal&#39;</span><span class="p">,</span> <span class="s1">&#39;F1ScoreOnVal&#39;</span><span class="p">])</span>
<span class="n">df_classifiers</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[233]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ModelName</th>
      <th>AccuracyOnTraining</th>
      <th>AccuracyOnval</th>
      <th>RecallOnVal</th>
      <th>SpecificityOnVal</th>
      <th>PrecisionOnVal</th>
      <th>BalancedAccuracyOnVal</th>
      <th>F1ScoreOnVal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>GridSearchCV RBF Kernel SVC</td>
      <td>0.94</td>
      <td>0.91</td>
      <td>0.87</td>
      <td>0.94</td>
      <td>0.90</td>
      <td>0.90</td>
      <td>0.88</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GridSearchCV RBF Kernel SVC With PCA transform...</td>
      <td>0.93</td>
      <td>0.91</td>
      <td>0.86</td>
      <td>0.94</td>
      <td>0.90</td>
      <td>0.90</td>
      <td>0.88</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Random Forest Classifier</td>
      <td>1.00</td>
      <td>0.92</td>
      <td>0.86</td>
      <td>0.95</td>
      <td>0.91</td>
      <td>0.91</td>
      <td>0.89</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Random Forest Classifier With Grid SearchCV</td>
      <td>0.96</td>
      <td>0.92</td>
      <td>0.87</td>
      <td>0.95</td>
      <td>0.91</td>
      <td>0.91</td>
      <td>0.89</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Gradient Boosting Classifier With Grid SearchCV</td>
      <td>0.99</td>
      <td>0.89</td>
      <td>0.84</td>
      <td>0.92</td>
      <td>0.88</td>
      <td>0.88</td>
      <td>0.86</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Voting Classifier With Hard voting</td>
      <td>0.92</td>
      <td>0.91</td>
      <td>0.85</td>
      <td>0.95</td>
      <td>0.91</td>
      <td>0.90</td>
      <td>0.88</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[234]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s calculate the difference between Accuracy on training and validation</span>
<span class="n">df_classifiers</span><span class="p">[</span><span class="s1">&#39;Differencebtn_trainAcc&amp;ValAcc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_classifiers</span><span class="p">[</span><span class="s1">&#39;AccuracyOnTraining&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_classifiers</span><span class="p">[</span><span class="s1">&#39;AccuracyOnval&#39;</span><span class="p">]</span>
<span class="c1">#df_classifiers</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>let&#39;s sort the data frame by RecallOnVal, F1-Score, Balanced Accuracy and Precision</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[235]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_classifiers_Sorted</span> <span class="o">=</span> <span class="n">df_classifiers</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RecallOnVal&#39;</span><span class="p">,</span> <span class="s1">&#39;F1ScoreOnVal&#39;</span><span class="p">,</span> <span class="s1">&#39;BalancedAccuracyOnVal&#39;</span><span class="p">,</span> <span class="s1">&#39;PrecisionOnVal&#39;</span><span class="p">])</span>
<span class="n">df_classifiers_Sorted</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[235]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ModelName</th>
      <th>AccuracyOnTraining</th>
      <th>AccuracyOnval</th>
      <th>RecallOnVal</th>
      <th>SpecificityOnVal</th>
      <th>PrecisionOnVal</th>
      <th>BalancedAccuracyOnVal</th>
      <th>F1ScoreOnVal</th>
      <th>Differencebtn_trainAcc&amp;ValAcc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Gradient Boosting Classifier With Grid SearchCV</td>
      <td>0.99</td>
      <td>0.89</td>
      <td>0.84</td>
      <td>0.92</td>
      <td>0.88</td>
      <td>0.88</td>
      <td>0.86</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Voting Classifier With Hard voting</td>
      <td>0.92</td>
      <td>0.91</td>
      <td>0.85</td>
      <td>0.95</td>
      <td>0.91</td>
      <td>0.90</td>
      <td>0.88</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GridSearchCV RBF Kernel SVC With PCA transform...</td>
      <td>0.93</td>
      <td>0.91</td>
      <td>0.86</td>
      <td>0.94</td>
      <td>0.90</td>
      <td>0.90</td>
      <td>0.88</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Random Forest Classifier</td>
      <td>1.00</td>
      <td>0.92</td>
      <td>0.86</td>
      <td>0.95</td>
      <td>0.91</td>
      <td>0.91</td>
      <td>0.89</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>0</th>
      <td>GridSearchCV RBF Kernel SVC</td>
      <td>0.94</td>
      <td>0.91</td>
      <td>0.87</td>
      <td>0.94</td>
      <td>0.90</td>
      <td>0.90</td>
      <td>0.88</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Random Forest Classifier With Grid SearchCV</td>
      <td>0.96</td>
      <td>0.92</td>
      <td>0.87</td>
      <td>0.95</td>
      <td>0.91</td>
      <td>0.91</td>
      <td>0.89</td>
      <td>0.04</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><ul>Based on the results of our table after sorting, the two best classifiers are:
    <li>Voting Classifier with Hard voting (Ensemble)</li>
    <li>GridSearchCV RBF Kernel SVC With PCA transformed data.</li>
</ul></p>
<p>I selected these two classifiers based on the F1 Score, Precision, Balanced Accuracy, Recall values and the difference between the values of training and validation accuracy. We see that the <b>Ensemble</b>, and <b>the RBF Kernel SVC </b>optimized with GridSearchCV and built with the PCA transformed data have low values of differences between training and validation accuracy which are 0.01 and 0.02 respectively.</p>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[236]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># We initilalize a list of the best two classifiers tested on the testing data set.</span>
<span class="n">best_two_classifiers_on_Test</span><span class="o">=</span><span class="p">[]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Using the Voting classifier with Hard Voting (Ensemble)<a rel="noopener" class="anchor-link" href="#Using-the-Voting-classifier-with-Hard-Voting-(Ensemble)">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[237]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pred_test_acc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">eclf</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">clf1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;rfr&#39;</span><span class="p">,</span> <span class="n">clf2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;gboost&#39;</span><span class="p">,</span> <span class="n">clf3</span><span class="p">)],</span> <span class="n">voting</span><span class="o">=</span><span class="s1">&#39;hard&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">clf</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">,</span> <span class="n">clf3</span><span class="p">,</span> <span class="n">eclf</span><span class="p">],</span> 
                      <span class="p">[</span><span class="s1">&#39;Logistic Regression&#39;</span><span class="p">,</span> <span class="s1">&#39;Random Forest&#39;</span><span class="p">,</span> <span class="s1">&#39;Gradient Boosting&#39;</span><span class="p">,</span> <span class="s1">&#39;Ensemble&#39;</span><span class="p">]):</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>
    <span class="n">pred_test_acc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_val_predict</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test_cat</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Testing Accuracy: </span><span class="si">%0.5f</span><span class="s2"> (+/- </span><span class="si">%0.3f</span><span class="s2">) [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">label</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Testing Accuracy: 0.87543 (+/- 0.045) [Logistic Regression]
Testing Accuracy: 0.86916 (+/- 0.052) [Random Forest]
Testing Accuracy: 0.85653 (+/- 0.058) [Gradient Boosting]
Testing Accuracy: 0.86354 (+/- 0.056) [Ensemble]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[238]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pred_test_calc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">pred_test_item</span> <span class="ow">in</span> <span class="n">pred_test_acc</span><span class="p">:</span>
    <span class="c1"># calculate the total accuracy on testing</span>
    <span class="n">pred_test_calc</span> <span class="o">+=</span> <span class="n">pred_test_item</span>
    
    
<span class="c1"># derive the average of the total accuracy on testing.</span>
<span class="n">pred_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_test_calc</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_test_acc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[239]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Dynamically calculating Recall(Sensitivity), Specificity, Precision, Balanced Accuracy and F1-Score</span>
<span class="n">TN</span><span class="p">,</span> <span class="n">FP</span><span class="p">,</span> <span class="n">FN</span><span class="p">,</span> <span class="n">TP</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">pred_test</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="c1"># return the elements of the matrix as array</span>

<span class="n">Specificity</span> <span class="o">=</span> <span class="n">TN</span><span class="o">/</span><span class="p">(</span><span class="n">TN</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span>

<span class="n">Precision</span> <span class="o">=</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span>

<span class="n">Recall</span> <span class="o">=</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span>

<span class="n">F1Score</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Precision</span> <span class="o">*</span> <span class="n">Recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Precision</span> <span class="o">+</span> <span class="n">Recall</span><span class="p">))</span>

<span class="n">BalancedAccuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">Recall</span>  <span class="o">+</span> <span class="n">Specificity</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recall (Sensivity): </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">Recall</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Specificity: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">Specificity</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Precision: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">Precision</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Balanced Accuracy: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">BalancedAccuracy</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;F1 Score: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">roundOffValue</span><span class="p">(</span><span class="n">F1Score</span><span class="p">))))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Recall (Sensivity): 0.84
Specificity: 0.94
Precision: 0.89
Balanced Accuracy: 0.89
F1 Score: 0.87
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[240]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">votingClassifierMetrics_testing</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Voting Classifier With Hard voting on testing set&#39;</span><span class="p">,</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test_cat</span><span class="p">,</span> <span class="n">pred_test</span><span class="p">)),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">Recall</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">Specificity</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">Precision</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">BalancedAccuracy</span><span class="p">),</span> <span class="n">roundOffValue</span><span class="p">(</span><span class="n">F1Score</span><span class="p">)]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[241]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># adding the metrics list of the voting Classifier metrics on testing to the list of list, best_two_classifiers_on_Test</span>
<span class="n">best_two_classifiers_on_Test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">votingClassifierMetrics_testing</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[242]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">best_two_classifiers_on_Test</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[242]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[[&#39;Voting Classifier With Hard voting on testing set&#39;,
  0.9,
  0.84,
  0.94,
  0.89,
  0.89,
  0.87]]</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Using GridSearchCV RBF Kernel SVC With PCA transformed data<a rel="noopener" class="anchor-link" href="#Using-GridSearchCV-RBF-Kernel-SVC-With-PCA-transformed-data">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[243]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># predict the accuracy on the testing transformed data set using PCA</span>
<span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">gridSearchCV_rbf_K_SVC_With_PCA_transformed_data</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_pca2</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[244]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">class_Metrics</span><span class="o">=</span><span class="n">deriveConfusionMatrix</span><span class="p">(</span><span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
<span class="n">listOfMetrics</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">class_Metrics</span><span class="p">)</span> <span class="c1"># convert the tuple into a list</span>
<span class="n">all_metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GridSearchCV RBF Kernel SVC With PCA transformed data&#39;</span><span class="p">,</span> 
                   <span class="n">roundOffValue</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test_cat</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred_test</span><span class="p">)),</span>  
                  <span class="p">]</span>
<span class="c1"># loop through the items of the list and add them to the list of all metrics</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">listOfMetrics</span><span class="p">:</span> 
    <span class="n">all_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
The Confusion Matrix is given below:
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
The classification report is given below:
              precision    recall  f1-score   support

         0.0       0.93      0.94      0.93       467
         1.0       0.89      0.89      0.89       272

    accuracy                           0.92       739
   macro avg       0.91      0.91      0.91       739
weighted avg       0.92      0.92      0.92       739

Recall (Sensivity): 0.89
Specificity: 0.94
Precision: 0.89
Balanced Accuracy: 0.91
F1 Score: 0.89
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[245]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># adding the all_metrics list to the list of list, best_two_classifiers_on_Test</span>
<span class="n">best_two_classifiers_on_Test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_metrics</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[246]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">best_two_classifiers_on_Test</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[246]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[[&#39;Voting Classifier With Hard voting on testing set&#39;,
  0.9,
  0.84,
  0.94,
  0.89,
  0.89,
  0.87],
 [&#39;GridSearchCV RBF Kernel SVC With PCA transformed data&#39;,
  0.92,
  0.89,
  0.94,
  0.89,
  0.91,
  0.89]]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[247]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># let&#39;s create a mask for the best two classifiers on training and validation</span>
<span class="n">classifier_mask</span> <span class="o">=</span> <span class="n">df_classifiers_Sorted</span><span class="p">[</span><span class="s1">&#39;ModelName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Voting Classifier With Hard voting&#39;</span><span class="p">,</span> <span class="s1">&#39;GridSearchCV RBF Kernel SVC With PCA transformed data&#39;</span><span class="p">])</span>
<span class="n">df_best_classifier_model</span> <span class="o">=</span> <span class="n">df_classifiers_Sorted</span><span class="p">[</span><span class="n">classifier_mask</span><span class="p">]</span>

<span class="c1"># let&#39;s create a copy of the data set.</span>
<span class="n">df_best_two_classifiers</span> <span class="o">=</span> <span class="n">df_best_classifier_model</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>Two best classifiers on training and validation data sets.</li>
</ul>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[248]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_best_two_classifiers</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[248]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ModelName</th>
      <th>AccuracyOnTraining</th>
      <th>AccuracyOnval</th>
      <th>RecallOnVal</th>
      <th>SpecificityOnVal</th>
      <th>PrecisionOnVal</th>
      <th>BalancedAccuracyOnVal</th>
      <th>F1ScoreOnVal</th>
      <th>Differencebtn_trainAcc&amp;ValAcc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>Voting Classifier With Hard voting</td>
      <td>0.92</td>
      <td>0.91</td>
      <td>0.85</td>
      <td>0.95</td>
      <td>0.91</td>
      <td>0.90</td>
      <td>0.88</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GridSearchCV RBF Kernel SVC With PCA transform...</td>
      <td>0.93</td>
      <td>0.91</td>
      <td>0.86</td>
      <td>0.94</td>
      <td>0.90</td>
      <td>0.90</td>
      <td>0.88</td>
      <td>0.02</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>So, the best two classifiers on the testing data:<a rel="noopener" class="anchor-link" href="#So,-the-best-two-classifiers-on-the-testing-data:">&#182;</a></h4>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[249]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_classifiers_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">best_two_classifiers_on_Test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ModelName&#39;</span><span class="p">,</span> <span class="s1">&#39;AccuracyOnTest&#39;</span><span class="p">,</span> <span class="s1">&#39;RecallOnTest&#39;</span><span class="p">,</span> <span class="s1">&#39;SpecificityOnTest&#39;</span><span class="p">,</span> <span class="s1">&#39;PrecisionOnTest&#39;</span><span class="p">,</span> <span class="s1">&#39;BalancedAccuracyOnTest&#39;</span><span class="p">,</span> <span class="s1">&#39;F1ScoreOnTest&#39;</span><span class="p">])</span>
<span class="n">df_classifiers_test</span> <span class="c1"># displaying the contents of the data frame</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[249]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ModelName</th>
      <th>AccuracyOnTest</th>
      <th>RecallOnTest</th>
      <th>SpecificityOnTest</th>
      <th>PrecisionOnTest</th>
      <th>BalancedAccuracyOnTest</th>
      <th>F1ScoreOnTest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Voting Classifier With Hard voting on testing set</td>
      <td>0.90</td>
      <td>0.84</td>
      <td>0.94</td>
      <td>0.89</td>
      <td>0.89</td>
      <td>0.87</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GridSearchCV RBF Kernel SVC With PCA transform...</td>
      <td>0.92</td>
      <td>0.89</td>
      <td>0.94</td>
      <td>0.89</td>
      <td>0.91</td>
      <td>0.89</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>From the data frame above, <b>RBF Kernel Support Vector Classifier(SVC)</b> optimized with GridSearchCV and built with PCA transformed data is the best model since using the testing data set it has a high Recall of 0.89, Specificity of 0.94, Balanced Accuracy of 0.91 and F1 Score of 0.89. These results are expected because using the PCA transformed data, all the correlated variables have been eliminated through PCA.</p>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>What did you learn in this project? Any suggestions?</li>
</ul>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ul>
<li>I learnt to explore several linear regressors using the given data set and from this exercise I should be in position to tackle any regression project. Also, I learnt using $R^2$ and $RMSE$ to measure the performance of any linear regression model used.</li>
<li>Through using GridSearchCV, I learnt tuning the performance of any linear regression model.</li>
<li>I learnt to transform the data using PCA. </li>
<li>I learnt to use my critical thinking skills on how to select the best model. </li>
<li>I learnt to convert a numerical target variable into binary category variable with the goal of doing classification.</li>
<li>I learnt how to build model using the PCA tranasformed data set.</li>
<li>I learnt how to split a data set into training and testing and again splitting the training and validation with the goal of using the testing data set only once after the model implementation and evaluation, which uses the training and validation data sets; here we only use the testing data set at the end after implementing and evaluating your model.</li>
<li>Finally, I also learnt how to explore different ways of improving the performance of the linear regressors and classifiers. </li>
</ul>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Thank you<a rel="noopener" class="anchor-link" href="#Thank-you">&#182;</a></h1><p>Ilyas Ustun<br/>
twitter: _ilyas_ustun_</p>

</div>
</div>









<script type="module" src="https://s.brightspace.com/lib/bsi/20.23.7-255/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						window.D2L.MathJax.loadMathJax({
							'outputScale': 1.5,
							'renderLatex': false
						});
					}
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/20.23.7-255/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script></body></html>